var gform=function(e,t){"use strict";this.handlers=e.events||{},_.map(e.events,function(e,t){_.isArray(e)||(this.handlers[t]=[e])}.bind(this)),this.sub=function(e,t){var n=e.split(" ");return"object"!=typeof this.handlers[e]&&(this.handlers[e]=[]),_.each(n,function(e){this.handlers[e].push(t)}.bind(this)),this}.bind(this),this.on=this.sub,this.pub=function(e,t,n){(n=n||{}).form=this,n.field=t;var i=[];return"string"==typeof e?i.push(e):i=i.concat(e),_.each(i,function(e,t){e.event=t;var n=function(t){t.call(null,e)}.bind(this);_.each(this.handlers[t],n),_.each(this.handlers["*"],n)}.bind(this,n)),this}.bind(this),this.options=_.assignIn({legend:"",default:gform.default,data:"search",columns:gform.columns,name:gform.getUID()},this.opts,e),"string"==typeof this.options.data&&(this.options.data=window.location[this.options.data].substr(1).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){return e[t[0]]=decodeURIComponent(t[1]),e},{})),this.options.sections&&_.each(_.filter(this.options.fields,{type:"fieldset"}),function(e,t){return e.index=t,e.section=!0,e.id=gform.getUID(),e}),this.el=t||e.el,"string"==typeof this.el?this.el=document.querySelector(this.el):t="",this.pub("initialize");var n=function(){void 0===this.el&&(this.options.renderer="modal",this.el=gform.create(gform.render("modal_container",this.options)),document.querySelector("body").appendChild(this.el),gform.addClass(this.el,"active"),this.sub("cancel",function(e){gform.removeClass(e.el,"active"),e.destroy(),document.body.removeChild(e.el),delete this.el}),this.sub("save",function(e){console.log(e.toJSON()),gform.removeClass(e.el,"active")}),this.el.querySelector(".close").addEventListener("click",function(e){this.pub("cancel",null,e)}.bind(this)),document.addEventListener("keyup",function(e){"Escape"===e.key&&this.pub("cancel",null,e)}.bind(this))),this.options.clear&&"modal"!=this.options.renderer&&(this.el.innerHTML=gform.render(this.options.sections+"_container",this.options)),this.container=this.el.querySelector("form")||this.el,this.rows={},this.fields=_.map(this.options.fields,gform.createField.bind(this,this,this.options.data||{},null,null)),_.each(this.fields,gform.inflate.bind(this,this.options.data||{})),gform.each.call(this,function(e){e.owner.pub("change:"+e.name,e)}),gform.instances[this.options.name]=this};this.restore=n.bind(this),this.toJSON=gform.toJSON.bind(this),this.reflow=gform.reflow.bind(this),this.set=function(e,t){_.find(this.fields,{name:e}).set(t)}.bind(this),this.find=gform.find.bind(this),this.isActive=!0,this.destroy=function(){this.pub("destroy"),this.el.innerHTML="",delete gform.instances[this.options.name],this.pub("destroyed")},n.call(this);var i=this.el.querySelector("ul.tabs");return null!==i&&i.addEventListener("click",function(e){"LI"==e.target.nodeName&&(e.preventDefault(),gform.removeClass(this.el.querySelector("ul.tabs .active"),"active"),gform.removeClass(this.el.querySelector(".tab-pane.active"),"active"),gform.addClass(e.target,"active"),gform.addClass(this.el.querySelector(e.target.parentElement.attributes.href.value),"active"))}.bind(this)),gform.types[this.fields[0].type].focus.call(this.fields[0]),this.el.addEventListener("click",function(e){var t;if(e.target.dataset.id&&(t=gform.findByID.call(this,e.target.dataset.id)),e.target.classList.contains("gform-add")){e.stopPropagation();var n=_.countBy(t.parent.fields,{name:t.name}).true;if(n<(t.array.max||5)){var i=_.findIndex(t.parent.fields,{id:t.id}),s=gform.createField.call(this,t.parent,{},t.el,null,t.item,null,null,n);t.parent.fields.splice(i+1,0,s),t.parent.reflow(),_.each(_.filter(t.parent.fields,{name:t.name}),function(e,t){e.update({index:t})}),gform.each.call(t.owner,function(e){e.owner.pub("change:"+e.name,e)}),gform.types[s.type].focus.call(s),t.owner.pub(["change","change:"+t.name,"create","create:"+t.name,"inserted","inserted:"+t.name],t)}}e.target.classList.contains("gform-minus")&&(e.stopPropagation(),_.countBy(t.parent.fields,{name:t.name}).true>(t.array.min||1)?(i=_.findIndex(t.parent.fields,{id:t.id}),t.parent.fields.splice(i,1),t.parent.reflow(),t.target?this.container.querySelector(t.target).removeChild(t.el):_.each(_.filter(t.parent.fields,{name:t.name}),function(e,t){e.update({index:t})}),t.owner.pub(["change","change:"+t.name,"removed","removed:"+t.name],t)):t.set(null))}.bind(this)),this};gform.each=function(e){_.each(this.fields,function(t){e(t),void 0!==t.fields&&gform.each.call(t,e)})},gform.find=function(e){var t=e.split("."),n=_.find(this.fields,{name:t.shift()});return void 0!==n?void 0!==n.find?n.name==e?n:n.find(t.join(".")):n:void 0!==this.parent&&"function"==typeof this.parent.find?this.parent.find(e):void 0},gform.findByID=function(e){var t=!1;return _.each(this.fields,function(n){n.id==e&&(t=n),t||void 0===n.fields||(t=gform.findByID.call(n,e))}),t},gform.toJSON=function(e){if("string"==typeof e&&e.length>0)return e=e.split("."),_.find(this.fields,{name:e.shift()}).get(e.join("."));var t={};return _.each(this.fields,function(e){e.parsable&&(e.array?(t[e.name]=t[e.name]||[],t[e.name].push(e.get())):t[e.name]=e.get())}.bind(this)),t},gform.m=function(e,t,n,i){function s(e,t){return e=e[(t=t.pop?t:t.split(".")).shift()]||"",0 in t?s(e,t):e}var r=gform.m,o="";t=_.isArray(t)?t:t?[t]:[],t=i?0 in t?[]:[1]:t;for(i=0;i<t.length;i++){var a,l="",c=0,f="object"==typeof t[i]?t[i]:{};(f=_.assign({},n,f))[""]={"":t[i]},e.replace(/([\s\S]*?)({{((\/)|(\^)|#)(.*?)}}|$)/g,function(e,t,n,i,u,d,h){c?l+=c&&!u||1<c?e:t:(o+=t.replace(/{{{(.*?)}}}|{{(!?)(&?)(>?)(.*?)}}/g,function(e,t,n,i,o,a){return t?s(f,t):i?s(f,a):o?r(s(f,a),f):n?"":new Option(s(f,a)).innerHTML}),a=d),u?--c||(h=s(f,h),o=/^f/.test(typeof h)?o+h.call(f,l,function(e){return r(e,f)}):o+r(l,h,f,a),l=""):++c})}return o},gform.reflow=function(){_.each(this.rows,function(e,t){this.container.removeChild(e.ref),delete this.rows[t]}.bind(this)),_.each(this.fields,function(e){if(e.columns>0){var t,n=e.parent.container.querySelectorAll("form > ."+e.owner.options.rowClass+",fieldset > ."+e.owner.options.rowClass);if(void 0!==(i=(n[n.length-1]||{}).id)&&(t=e.parent.rows[i]),void 0===t||t.used+parseInt(e.columns,10)+parseInt(e.offset,10)>e.owner.options.columns||1==e.row){var i=gform.getUID();(t={}).used=0,t.ref=document.createElement("div"),t.ref.setAttribute("id",i),t.ref.setAttribute("class",e.owner.options.rowClass),t.ref.setAttribute("style","margin-bottom:0;"),e.parent.rows[i]=t,e.parent.container.appendChild(t.ref)}t.used+=parseInt(e.columns,10),t.used+=parseInt(e.offset,10),t.ref.appendChild(e.el),e.row=i}})},gform.instances={},gform.inflate=function(e,t,n,i){var s=i;t.array&&(s=_.uniqBy(s,"name"));var r=_.findLast(s,{name:s[n].name});if(!r.array&&r.fields&&_.each(r.fields,gform.inflate.bind(this,e[r.name]||r.owner.options.data[r.name]||{})),r.array){var o=r.array.min||0;"object"!=typeof e[r.name]&&"object"==typeof r.owner.options.data[r.name]&&(e=r.owner.options.data),"object"==typeof e[r.name]&&e[r.name].length>1&&e[r.name].length>o&&(o=e[r.name].length);for(var a=1;a<o;a++){var l=gform.createField.call(this,r.parent,e,r.el,a,r.item,null,null,a);r.parent.fields.splice(_.findIndex(r.parent.fields,{id:r.id})+1,0,l),r=l}}},gform.normalizeField=function(e,t){t=t||null,e.type=e.type||this.options.default.type;var n=_.assignIn({name:(gform.renderString(e.label)||"").toLowerCase().split(" ").join("_"),id:gform.getUID(),label:e.legend||e.name,validate:[],valid:!0,parsable:!0,visible:!0,enabled:!0,parent:t,array:!1,columns:this.options.columns||gform.columns,offset:0,ischild:!(t instanceof gform)},this.opts,gform.default,this.options.default,gform.types[e.type].defaults,e);return""==n.name&&(n.name=n.id),n.item=e,n},gform.createField=function(e,t,n,i,s,r,o,a){var l=gform.normalizeField.call(this,s,e);if(l.owner=this,l.columns>this.options.columns&&(l.columns=this.options.columns),l.array&&"object"==typeof(t[l.name]||l.owner.options.data[l.name])?l.value=(t[l.name]||l.owner.options.data[l.name])[i||0]||{}:l.value=t[l.name]||l.owner.options.data[l.name]||l.value,0!==l.item.value?l.array&&"object"==typeof t[l.name]?l.value=t[l.name][i||0]:"function"==typeof l.item.value?(l.valueFunc=l.item.value,l.derivedValue=function(){return l.valueFunc.call(l,l.owner.toJSON())},l.item.value=l.item.value=l.derivedValue(),l.owner.sub("change",function(){this.set.call(this,this.derivedValue())}.bind(l))):l.value=t[l.name]||l.value||"":l.value=0,l.index=a||0,l.label=gform.renderString(l.item.label||l.label,l),l.satisfied=l.satisfied||gform.types[l.type].satisfied.bind(l),l.update=gform.types[l.type].update.bind(l),l.destroy=gform.types[l.type].destroy.bind(l),l.active=function(){return this.parent.active()&&this.enabled&&this.parsable&&this.visible},l.set=function(e,t){this.value!=e&&"object"!=typeof e&&(this.value=e,gform.types[this.type].set.call(this,e),t||this.owner.pub(["change:"+this.name,"change"],this))}.bind(l),l.get=l.get||gform.types[l.type].get.bind(l),l.render=l.render||gform.types[l.type].render.bind(l),l.el=gform.types[l.type].create.call(l),l.container=l.el.querySelector("fieldset")||l.el||null,void 0!==gform.types[l.type].reflow&&(l.reflow=gform.types[l.type].reflow.bind(l)||null),void 0!==gform.types[l.type].find&&(l.find=gform.types[l.type].find.bind(l)||null),l.target||l.section||!this.options.clear&&!l.isChild)l.target||(l.target='[name="'+l.name+'"],[data-inline="'+l.name+'"]'),null!=(u=this.el.querySelector(l.target))?u.appendChild(l.el):l.section&&l.owner.el.querySelector("."+l.owner.options.sections+"-content").appendChild(l.el);else if(l.columns>0){var c,f=l.parent.container.querySelectorAll("form > ."+l.owner.options.rowClass+",fieldset > ."+l.owner.options.rowClass);if(void 0!==(u=(f[f.length-1]||{}).id)&&(c=l.parent.rows[u]),void 0===c||c.used+parseInt(l.columns,10)+parseInt(l.offset,10)>this.options.columns||1==l.row){var u=gform.getUID();(c={}).used=0,c.ref=document.createElement("div"),c.ref.setAttribute("id",u),c.ref.setAttribute("class",l.owner.options.rowClass),c.ref.setAttribute("style","margin-bottom:0;"),l.parent.rows[u]=c,l.parent.container.appendChild(c.ref)}c.used+=parseInt(l.columns,10),c.used+=parseInt(l.offset,10),c.ref.appendChild(l.el),l.row=u}if(gform.types[l.type].initialize.call(l),l.fields){var d;d=l.array&&"object"==typeof(t[l.name]||l.owner.options.data[l.name])?(t[l.name]||l.owner.options.data[l.name])[i||0]||{}:t[l.name]||l.owner.options.data[l.name]||{},l.fields=_.map(l.fields,gform.createField.bind(this,l,d,null,null)),l.array&&_.each(l.fields,gform.inflate.bind(this,d))}return gform.processConditions.call(l,l.display,function(e){this.el.style.display=e?"block":"none",this.visible=e}),gform.processConditions.call(l,l.enable,function(e){this.enabled=e,gform.types[this.type].enable.call(this,this.enabled)}),gform.processConditions.call(l,l.parse,function(e){this.parsable=e}),l.required&&gform.processConditions.call(l,l.required,function(e){this.required!==e&&this.update({required:e})}),l},gform.rows={add:function(e){var t=gform.getUID();return cRow={},cRow.used=0,cRow.ref=document.createElement("div"),cRow.ref.setAttribute("id",t),cRow.ref.setAttribute("class",this.options.rowClass),cRow.ref.setAttribute("style","margin-bottom:0;"),e.rows[t]=cRow,e.container.appendChild(cRow.ref),cRow},remove:function(){}},gform.ajax=function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&(200===t.status?e.success(JSON.parse(t.responseText)):(console.log(t.responseText),e.error(t.responseText)))},t.open(e.verb||"GET",e.path),t.send()},gform.default={type:"text",format:{label:"{{label}}",value:"{{value}}"}},gform.prototype.opts={clear:!0,sections:"",suffix:":",rowClass:"row",requiredText:'<span style="color:red">*</span>'},gform.optionsObj=function(e,t,n){if(void 0!==e.max&&""!==e.max)for(var i=e.min||0;i<=e.max;i+=e.step||1)e.options.push(""+i);return _.map(e.options,function(e,i,s){return"object"==typeof i&&"optgroup"==i.type?(i.options=gform.optionsObj.call(this,_.merge({options:[]},gform.default,i),t,n),i.id=gform.getUID(),gform.processConditions.call(this,i.enable,function(e,t){for(var n=this.el.querySelectorAll('[data-id="'+e+'"]'),i=0;i<n.length;i++)n[i].disabled=!t}.bind(this,i.id)),gform.processConditions.call(this,i.display,function(e,t){for(var n=this.el.querySelectorAll('[data-id="'+e+'"]'),i=0;i<n.length;i++)n[i].hidden=!t}.bind(this,i.id)),n+=i.options.length,{section:i}):("string"!=typeof i&&"number"!=typeof i||(i={label:i,value:i}),i.index=i.index||""+n,_.assignIn(i,{label:gform.renderString(e.format.label,i),value:gform.renderString(e.format.value,i)}),i.value==t&&(i.selected=!0),n+=1,i)}.bind(this,e))},gform.options=function(e,t,n){n=n||0;var i={options:[]};return"object"!=typeof e.options||_.isArray(e.options)||_.merge(i.options,e.options),"function"==typeof e.options&&(i.action=e.options,e.options=i.action.call(this)),"string"==typeof e.options||"string"==typeof i.url?(i.path=e.options,i.options=!1,i.url=null,gform.ajax({path:i.path,success:function(e){this.options=e,this.options=gform.options.call(this,this,this.value),this.update()}.bind(this)}),i):(e=_.merge({options:[]},gform.default,e),i.options=gform.optionsObj.call(this,e,t,n),"string"==typeof e.placeholder&&i.options.unshift({label:e.placeholder,value:"",enabled:!1,visible:!1,selected:!0}),i.options)},gform.VERSION="0.0.0.3",gform.i=0,gform.getUID=function(){return"f"+gform.i++},gform.types={input:{defaults:{},create:function(){var e=document.createElement("span");return e.setAttribute("id",this.id),e.setAttribute("class",""+gform.columnClasses[this.columns]),e.innerHTML=this.render(),e},render:function(){return gform.render(this.type,this)},destroy:function(){this.el.removeEventListener("input",this.onchangeEvent)},initialize:function(){this.onchangeEvent=function(){this.value=this.get(),this.owner.pub(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this),this.el.addEventListener("input",this.onchangeEvent.bind(null,!0))},update:function(e,t){"object"==typeof e&&_.extend(this,this.item,e),this.label=gform.renderString((e||{}).label||this.item.label,this);var n=document.getElementById(this.id);this.destroy(),this.el=gform.types[this.type].create.call(this),n.parentNode.replaceChild(this.el,n),gform.types[this.type].initialize.call(this),t||this.owner.pub(["change:"+this.name,"change"],this)},get:function(){return this.el.querySelector('input[name="'+this.name+'"]').value},set:function(e){this.el.querySelector('input[name="'+this.name+'"]').value=e},satisfied:function(e){return void 0!==this.value&&null!==this.value&&""!==this.value},enable:function(e){this.el.querySelector('[name="'+this.name+'"]').disabled=!e},find:function(){return this},focus:function(){this.el.querySelector('[name="'+this.name+'"]').focus();var e=this.value;this.set(""),this.set(e)}},bool:{defaults:{options:[!1,!0]},render:function(){return this.selected=this.value==this.options[1],gform.render(this.type,this)},set:function(e){this.selected=e==this.options[1],this.el.querySelector('input[name="'+this.name+'"]').checked=this.selected},get:function(){return this.options[this.el.querySelector('input[name="'+this.name+'"]').checked?1:0]}},collection:{render:function(){return this.options=gform.options.call(this,this,this.value),gform.render(this.type,this)},initialize:function(){this.el.addEventListener("change",function(){this.value=this.get(),this.owner.pub(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this))},get:function(){return this.el.querySelector("select").value},set:function(e){this.el.querySelector("select").value=e,_.each(this.options.options,function(t,n){t.value!=e&&parseInt(t.value)!=parseInt(e)||(this.el.querySelector('[name="'+this.name+'"]').selectedIndex=n)}.bind(this))}},section:{create:function(){var e=document.createRange().createContextualFragment(this.render()).firstElementChild;return gform.addClass(e,gform.columnClasses[this.columns]),e},initialize:function(){this.rows={}},render:function(){return gform.render(this.owner.options.sections+"_fieldset",this)},update:function(e,t){"object"==typeof e&&_.extend(this.item,e),this.label=gform.renderString(({}||e).label||this.item.label,this);var n=document.getElementById(this.id);this.destroy(),this.el=gform.types[this.type].create.call(this),n.parentNode.replaceChild(this.el,n),gform.types[this.type].initialize.call(this),this.container=this.el.querySelector("fieldset")||this.el||null,this.reflow(),t||this.owner.pub(["change:"+this.name,"change"],this)},get:function(e){return gform.toJSON.call(this,e)},find:function(e){return gform.find.call(this,e)},reflow:function(){gform.reflow.call(this)},focus:function(){gform.types[this.fields[0].type].focus.call(this.fields[0])}},button:{defaults:{parsable:!1,columns:2,target:".footer"},create:function(){var e=document.createRange().createContextualFragment(this.render()).firstElementChild;return e.setAttribute("id",this.id),e},initialize:function(){this.action=this.action||(this.label||"").toLowerCase().split(" ").join("_"),this.onclickEvent=function(){this.enabled&&this.owner.pub(this.action,this)}.bind(this),this.el.addEventListener("click",this.onclickEvent)},render:function(){return gform.render("button",this)},satisfied:function(e){return this.enabled&&this.visible},update:function(e,t){"object"==typeof e&&_.extend(this,this.item,e),this.label=gform.renderString(this.item.label,this);var n=document.getElementById(this.id);this.destroy(),this.el=gform.types[this.type].create.call(this),n.parentNode.replaceChild(this.el,n),gform.types[this.type].initialize.call(this)},destroy:function(){this.el.removeEventListener("click",this.onclickEvent)},get:function(e){return null},set:function(e){},enable:function(e){this.el.disabled=!e}}},gform.render=function(e,t){return gform.m(gform.stencils[e||"text"]||gform.stencils.text,_.extend({},gform.stencils,t))},gform.create=function(e){return document.createRange().createContextualFragment(e).firstElementChild},gform.renderString=function(e,t){return gform.m(e||"",t||{})},gform.addClass=function(e,t){e.className=_.chain(e.className).split(/[\s]+/).union(t.split(" ")).join(" ").value()},gform.removeClass=function(e,t){e.className=_.chain(e.className).split(/[\s]+/).difference(t.split(" ")).join(" ").value()},gform.types.text=gform.types.password=gform.types.number=gform.types.color=gform.types.input,gform.types.hidden=_.extend({},gform.types.input,{defaults:{columns:!1}}),gform.types.textarea=_.extend({},gform.types.input,{set:function(e){this.el.querySelector('textarea[name="'+this.name+'"]').innerHTML=e},get:function(){return this.el.querySelector('textarea[name="'+this.name+'"]').value}}),gform.types.checkbox=_.extend({},gform.types.input,gform.types.bool),gform.types.fieldset=_.extend({},gform.types.input,gform.types.section),gform.types.select=_.extend({},gform.types.input,gform.types.collection),gform.types.range=_.extend({},gform.types.input,gform.types.collection,{get:function(){return(this.el.querySelector("range")||{value:""}).value},set:function(e){this.el.querySelector("range").value=e}}),gform.types.radio=_.extend({},gform.types.input,gform.types.collection,{get:function(){return(this.el.querySelector('[type="radio"][name="'+this.name+'"]:checked')||{value:""}).value},set:function(e){this.el.querySelector('[value="'+e+'"]').checked="checked"}}),gform.types.email=_.extend({},gform.types.input,{defaults:{validate:{valid_email:!0}}}),gform.processConditions=function(e,t){if("string"==typeof e&&("display"===e||"enable"===e||"parse"===e?e=this.item[e]:"enable"===e&&(e=this.item.enable)),"boolean"==typeof e&&t.call(this,e),"function"==typeof e&&t.call(this,e.call(this)),"object"==typeof e){var n=function(e,t){t.call(this,gform._rules.call(this,e))}.bind(this,e,t);gform._subscribeByName.call(this,e,n)}return!0},gform._subscribeByName=function(e,t){for(var n in e)void 0!==e[n].name?this.owner.sub("change:"+e[n].name,t):"object"==typeof e[n].conditions&&gform._subscribeByName.call(this,e[n].conditions,t)},gform._rules=function(e,t){return t=t||"and",_.reduce(e,function(e,n){var i;return void 0!==n.conditions?(i=gform._rules.call(this,n.conditions,n.op),console.log(i)):i=gform.conditions[n.type](this,n),"or"==t?e||i:e&&i}.bind(this),"and"==t)},gform.conditions={requires:function(e,t,n){return e.sub("change:"+t.name,function(e,t,i,s){n.call(this,t.find(e.path).satisfied(),s)}.bind(this,t))},not_matches:function(e,t){var n=t.value,i=(e.parent.find(t.name)||{value:""}).value;return"object"==typeof n&&null!==i?-1==n.indexOf(i):n!==i},test:function(e,t,n){return e.sub("change:"+t.name,function(e,t,i,s){n.call(this,e.callback(),s)}.bind(this,t))},matches:function(e,t){var n=t.value,i=(e.parent.find(t.name)||{value:""}).value;return"object"==typeof n&&null!==i?-1!==n.indexOf(i):n==i}},gform.prototype.errors={},gform.prototype.validate=function(){return this.valid=!0,_.each(this.fields,gform.validateItem),this.valid?this.pub("valid"):this.pub("invalid",{errors:this.errors}),this.pub("validation"),this.valid},gform.handleError=gform.update,gform.validateItem=function(e){var t=e.get();if(e.valid=!0,e.errors="",e.parsable&&"object"==typeof e.validate){var n=gform.validation.call(e,e.validate);if(e.required){var i=!e.satisfied(t)&&"{{label}} is required";i&&n.push(gform.renderString(e.required.message||i,{label:e.label,value:t,args:e.required}))}n=_.compact(n),(void 0===e.display||e.visible)&&(e.valid=!n.length,e.errors=n.join("<br>"),gform.handleError(e)),void 0!==e.fields&&_.each(e.fields,gform.validateItem)}e.errors?e.owner.pub("invalid:"+e.name,{errors:e.errors}):e.owner.pub("valid:"+e.name),e.owner.errors[e.name]=e.errors,e.owner.valid=e.valid&&e.owner.valid},gform.validation=function(e,t){t=t||"and";var n=this.get(),i=_.map(e,function(e,t){if("string"==typeof t.type){if(void 0===t.conditions||gform._rules.call(this,t.conditions)){var i=e[t.type].call(this,n,t);if(i)return gform.renderString(t.message||i,{label:this.label,value:n,args:t})}}else if(void 0!==t.tests)return gform.validation.call(this,t.tests,t.op).join("<br>")}.bind(this,gform.validations));return"and"==t||_.compact(i).length==e.length?i:[]},gform.regex={numeric:/^[0-9]+$/,decimal:/^\-?[0-9]*\.?[0-9]+$/,url:/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,date:/^(0[1-9]|1[0-2])\/(0[1-9]|1\d|2\d|3[01])\/(19|20)\d{2}$/,email:/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,6}$/i},gform.validations={regex:function(e,t){var n=t.regex;return"string"==typeof n&&(n=gform.regex[n]),!n.test(e)&&""!==e&&t.message},custom:function(e,t){return t.call(this,e)},matches:function(e,t){var n=this.parent.find(t.name);return t.label=n.label,t.value=n.get(),void 0===n?"Matching field not defined":e!=t.value&&'"{{label}}" does not match the "{{args.label}}" field'},date:function(e){return!gform.regex.date.test(e)&&""!==e&&"{{label}} should be in the format MM/DD/YYYY"},valid_url:function(e){return!gform.regex.url.test(e)&&""!==e&&"{{label}} must contain a valid Url"},valid_email:function(e){return!gform.regex.email.test(e)&&""!==e&&"{{label}} must contain a valid email address"},length:function(e,t){return gform.regex.numeric.test(t.max)||gform.regex.numeric.test(t.min)?"number"==typeof t.max&&"number"==typeof t.min&&t.min==t.max?t.min!=e.length&&"{{label}} must be exactly "+t.min+" characters in length":"number"==typeof t.max&&e.length>t.max?"{{label}} must not exceed "+t.max+" characters in length":"number"==typeof t.min&&e.length>0&&e.length<t.min&&"{{label}} must be at least "+t.min+" characters in length":"Invalid length requirement"},numeric:function(e,t){return gform.regex.decimal.test(e)||""===e?"number"==typeof t.min&&parseFloat(e)<parseFloat(t.min)?"{{label}} must contain a number greater than {{args.min}}":"number"==typeof t.max&&parseFloat(e)>parseFloat(t.max)?"{{label}} must contain a number less than {{args.max}}":void 0:"{{label}} must contain only numbers"}};
gform.stencils={_container:'<form id="{{name}}" {{^autocomplete}}autocomplete="false"{{/autocomplete}} name="{{name}}" class="gform {{^options.inline}} smart-form-horizontal form-horizontal{{/options.inline}} {{modifiers}}" {{#action}}action="{{action}}"{{/action}} onsubmit="return false;" {{#method}}method="{{method}}"{{/method}}>{{^legendTarget}}{{#legend}}<legend>{{{legend}}}</legend>{{/legend}}{{/legendTarget}}</form><div class="footer row"></div>',text:'<div class="row clearfix form-group {{modifiers}} {{#array}}dupable" data-min="{{multiple.min}}" data-max="{{multiple.max}}{{/array}}" name="{{name}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12">{{/inline}}\n\t{{^inline}}<div class="col-md-8">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t<div class="col-md-12">\n\t{{/label}}\n\t\t{{#pre}}<div class="input-group col-xs-12"><span class="input-group-addon">{{{pre}}}</span>{{/pre}}\n    {{^pre}}{{#post}}<div class="input-group">{{/post}}{{/pre}}\n\t\t<input {{^autocomplete}}autocomplete="off"{{/autocomplete}} class="form-control" {{^enabled}}readonly{{/enabled}} {{#maxLength}}maxlength="{{maxLength}}"{{/maxLength}}{{#min}} min="{{min}}"{{/min}}{{#max}} max="{{max}}"{{/max}} {{#step}} step="{{step}}"{{/step}} placeholder="{{placeholder}}" type="{{elType}}{{^elType}}{{type}}{{/elType}}" name="{{name}}" id="{{name}}" value="{{value}}" />\n    {{#post}}<span class="input-group-addon">{{{post}}}</span></div>{{/post}}\n    {{^post}}{{#pre}}</div>{{/pre}}{{/post}}\n\t\t{{>_addons}}\n\t\t{{>_actions}}\n\t</div>\n</div>',hidden:'<input type="hidden" name="{{name}}" value="{{value}}" />{{>_addons}}',textarea:'<div class="row clearfix form-group {{modifiers}} {{#array}}dupable" data-min="{{multiple.min}}" data-max="{{multiple.max}}{{/array}}" name="{{name}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12" {{#advanced}}style="padding:0px 13px"{{/advanced}}>{{/inline}}\n\t{{^inline}}<div class="col-md-8" {{#advanced}}style="padding:0px 13px"{{/advanced}}>{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t<div class="col-md-12" {{#advanced}}style="padding:0px 13px"{{/advanced}}>\n\t{{/label}}\n\t\t<textarea class="form-control"  {{^enabled}}readonly{{/enabled}} {{#maxLength}}maxlength="{{maxLength}}"{{/maxLength}} style="width:100%;height:auto;min-height:20px" rows="{{rows}}{{^rows}}3{{/rows}}" name="{{name}}" id="{{guid}}" placeholder="{{placeholder}}">{{content}}{{value}}</textarea>\n\t\t\t{{>_addons}}\n\t\t\t{{>_actions}}\n\t</div>\n</div>',select:'<div class="row clearfix form-group {{modifiers}} {{#array}}dupable" data-min="{{multiple.min}}" data-max="{{multiple.max}}{{/array}}" name="{{name}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12">{{/inline}}\n\t{{^inline}}<div class="col-md-8">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t<div class="col-md-12">\n\t{{/label}}\n\t\t{{#pre}}<div class="input-group"><span class="input-group-addon">{{{pre}}}</span>{{/pre}}\n\t\t{{^pre}}{{#post}}<div class="input-group">{{/post}}{{/pre}}\n\t\t\t<select class="form-control"  name="{{name}}" {{^enabled}}readonly disabled="true"{{/enabled}}  {{#multiple_enable}}multiple{{/multiple_enable}} >\n\t\t\t{{#options}}\n\n\t\t\t\t{{^section}}\n\t\t\t\t<option {{#selected}}selected=\'selected\'{{/selected}} {{^enabled}}disabled{{/enabled}} {{^visible}}hidden{{/visible}}  value="{{value}}">{{{label}}}</option>\n\t\t\t\t{{/section}}\n\n\t\t\t\t\n\t\t\t\t{{#section}}\n\t\t\t\t{{#section.label}}\n\t\t\t\t<optgroup label="{{label}}" data-id="{{section.id}} {{^enabled}}disabled{{/enabled}} {{^visible}}hidden{{/visible}}">\n\t\t\t\t{{/section.label}}\n\t\t\t\t\t{{#options}}\n\t\t\t\t\t<option data-id="{{section.id}}" {{#selected}}selected=\'selected\'{{/selected}} {{^enabled}}disabled{{/enabled}} {{^visible}}hidden{{/visible}}  value="{{value}}">{{{label}}}</option>\n\t\t\t\t\t{{/options}}\n\t\t\t\t\t{{#section.label}}\n\t\t\t\t</optgroup>\n\t\t\t\t{{/section.label}}\n\t\t\t\t{{/section}}\n\n\t\t\t{{/options}}\n\t\t\t</select>\n\t\t{{#post}}<span class="input-group-addon">{{{post}}}</span></div>{{/post}}\n\t\t{{^post}}{{#pre}}</div>{{/pre}}{{/post}}\n\t\t{{>_addons}}\n\t\t{{>_actions}}\n\t</div>\n</div>',select_options:"\n{{>select_options}}\n\n",radio:'<div class="row clearfix form-group {{modifiers}} {{#array}}dupable" data-min="{{multiple.min}}" data-max="{{multiple.max}}{{/array}}" name="{{name}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12">{{/inline}}\n\t{{^inline}}<div class="col-md-8">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t<div class="col-md-12">\n\t{{/label}}\n\t\t{{#pre}}<div class="input-group"><span class="input-group-addon">{{{pre}}}</span>{{/pre}}\n\t\t{{^pre}}{{#post}}<div class="input-group">{{/post}}{{/pre}}\n\t\t\t{{#options}}\n\t\t\t<div class="radio">\n\t\t\t\t<label {{#inline}}class="radio-inline"{{/inline}}>\n\t\t\t\t\t<input data-label="{{label}}" name="{{name}}" value="{{value}}" {{^enabled}}readonly{{/enabled}} type="radio" {{#selected}}checked=checked{{/selected}} >\n\t\t\t\t\t{{{label}}}{{^label}}&nbsp;{{/label}}\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t{{/options}}\n\t\t{{#post}}<span class="input-group-addon">{{{post}}}</span></div>{{/post}}\n\t\t{{^post}}{{#pre}}</div>{{/pre}}{{/post}}\n\t\t{{>_addons}}\n\t\t{{>_actions}}\n\t</div>\n</div>',_fieldset:'<div class="row"><fieldset data-type="fieldset" name="{{name}}" id="{{id}}" class="{{modifiers}} col-md-12" >\n{{#array}}\n<div class="btn-group actions">\n\t<div data-id="{{id}}" class="gform-add btn btn-white"><i class="fa fa-plus text-success"></i></div><div data-id="{{id}}" class="btn btn-white gform-minus"><i class="fa fa-minus text-danger"></i></div>\n</div>\n{{/array}}\n{{^hideLabel}}\n{{#item.legend}}<legend>{{{item.legend}}}</legend>{{/item.legend}}\n{{^item.legend}}\n{{#item.label}}<legend>{{{item.label}}}</legend>{{/item.label}}\n{{/item.legend}}\n{{/hideLabel}}\n<div style="position:relative;top:-20px">{{>_addons}}</div>\n</fieldset></div>',_actions:'{{#array}}\n\t<div class="btn-group actions pull-right">\n\t<div data-id="{{id}}" class="gform-add btn btn-white"><i data-id="{{id}}" class="gform-add fa fa-plus text-success"></i></div>\n\t<div data-id="{{id}}" class="btn btn-white gform-minus"><i data-id="{{id}}" class="gform-minus fa fa-minus text-danger"></i></div>\n\t</div>\n\t{{/array}}',_label:'\n    {{^hideLabel}}\n\t{{#label}}<label for="{{guid}}" {{#inline}}style="text-align:left"{{/inline}} class="control-label col-md-{{#inline}}12{{/inline}}{{^inline}}4{{/inline}}">\n  {{{label}}}{{#validate.required}}{{{requiredText}}}{{/validate.required}}{{suffix}}\n</label>{{/label}}\n{{/hideLabel}}\n    ',_addons:'<span class="help-inline"> {{{help}}}</span>\n<span class="font-xs text-danger" style="display:block;"></span>',checkbox:'<div class="row clearfix {{modifiers}} {{#array}}dupable" data-min="{{multiple.min}}" data-max="{{multiple.max}}{{/array}}" name="{{name}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12" style="margin:0 0 5px">{{/inline}}\n\t{{^inline}}<div class="col-md-8" style="margin:0 0 15px">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t{{#inline}}<div class="col-md-12" style="margin: -10px 0 5px;"">{{/inline}}\n\t{{^inline}}<div class="col-md-8" style="margin: -5px 0 10px">{{/inline}}\n\t{{/label}}\n\t\t<div class="checkbox">\n\t\t\t<label class="{{alt-display}}">\n\t\t\t\t<input name="{{name}}" type="checkbox" {{^enabled}}disabled{{/enabled}} {{#value}}checked=checked{{/value}}>{{#container}}<{{container}}  style="position:relative;display:inline-block;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;">{{{text}}}</{{container}}>{{/container}}\n\t\t\t</label>\n\t\t</div>\n\t{{#post}}<span class="input-group-addon">{{{post}}}</span></div>{{/post}}\n\t\t{{>_addons}}\n\t\t{{>_actions}}\n\t</div>\n</div>',button:'<div class="btn btn-default {{modifiers}}" style="margin:0 15px">{{{label}}}</div>',tab_container:'\n<form id="{{name}}" style="overflow:hidden" {{^autocomplete}}autocomplete="false"{{/autocomplete}} name="{{name}}" class="gform tab-content {{^options.inline}} smart-form-horizontal form-horizontal{{/options.inline}} {{modifiers}}" {{#action}}action="{{action}}"{{/action}} onsubmit="return false;" {{#method}}method="{{method}}"{{/method}}>{{^legendTarget}}{{#legend}}<legend>{{{legend}}}</legend>{{/legend}}{{/legendTarget}}    \n\t<ul class="nav nav-tabs" style="margin-bottom:15px">\n\t\t{{#fields}}\n        {{#section}}\n\t\t<li {{^index}}class="active"{{/index}}>\n            <a href="#tabs{{id}}" data-toggle="tab">{{{legend}}}</a>\n        </li>\n\t    {{/section}}\t\t\n\t\t{{/fields}}\n\t</ul></form>\n\t</form><div class="footer row"></div>\n    ',tab_fieldset:'{{#section}}<div class="tab-pane {{^index}}active{{/index}} " id="tabs{{id}}">{{/section}}{{>_fieldset}}{{#section}}</div>{{/section}}',modal_container:'<div class="modal fade" id="myModal{{name}}" data-update="{{update}}" data-append="{{append}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n\t<div class="modal-dialog">\n\t\t<div class="modal-content">\n\t\t\t<div class="modal-header {{modal.header_class}}">\n\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n\t\t\t\t<h4 class="modal-title" id="myModalLabel">{{#icon}}<i class="fa fa-{{icon}}"></i> {{/icon}}{{{title}}}{{{legend}}}&nbsp;</h4>\n\t\t\t</div>\n\t\t\t<div class="modal-body">\n\t\t\t\t{{{body}}}\n\t\t\t\t{{^sections}}\n\t\t\t\t<form id="{{name}}" style="overflow:hidden" {{^autocomplete}}autocomplete="false"{{/autocomplete}} name="{{name}}" class="gform {{^options.inline}} smart-form-horizontal form-horizontal{{/options.inline}} {{modifiers}}" {{#action}}action="{{action}}"{{/action}} onsubmit="return false;" {{#method}}method="{{method}}"{{/method}}></form>\n\t\t\t\t{{/sections}}\n\t\t\t\t{{#sections}}\n\t\t\t\t<form id="{{name}}" style="overflow:hidden" {{^autocomplete}}autocomplete="false"{{/autocomplete}} name="{{name}}" class="gform tab-content {{^options.inline}} smart-form-horizontal form-horizontal{{/options.inline}} {{modifiers}}" {{#action}}action="{{action}}"{{/action}} onsubmit="return false;" {{#method}}method="{{method}}"{{/method}}>   \n\t\t\t\t<ul class="nav nav-tabs" style="margin-bottom:15px">\n\t\t\t\t\t{{#fields}}\n\t\t\t\t\t{{#section}}\n\t\t\t\t\t<li {{^index}}class="active"{{/index}}>\n\t\t\t\t\t\t<a href="#tabs{{id}}" data-toggle="tab">{{{legend}}}</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t{{/section}}\t\t\n\t\t\t\t\t{{/fields}}\n\t\t\t\t</ul></form>\n\t\t\t\t{{/sections}}\n\t\t\t\t\n\t\t\t</div>\n\t\t\t<div class="modal-footer"  style="padding-right: 0;padding-left: 0;">\n\t\t\t\t{{{footer}}}\n\t\t\t\t<div class="footer"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n',modal_fieldset:"{{>_fieldset}}"},gform.columns=12,gform.columnClasses=_.map(new Array(13),function(t,e){return"col-md-"+e}),gform.default.inline=!0,gform.prototype.opts.suffix="",gform.handleError=function(t){t.valid?t.el.querySelector(".font-xs.text-danger").innerHTML="":(t.el.classList.add("has-error"),t.el.querySelector(".font-xs.text-danger").innerHTML=t.errors)},gform.types.combo=_.extend({},gform.types.input,gform.types.collection,{initialize:function(){$('select[name="'+this.name+'"]').combobox({appendId:this.id}),this.onchangeEvent=function(){this.value=this.get(),this.owner.pub(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this),$(this.el).find("select").on("change",this.onchangeEvent)},destroy:function(){$(this.el).find("select").off("change",this.onchangeEvent)},update:function(t,e){"object"==typeof t&&_.extend(this,this.item,t),this.label=gform.renderString((t||{}).label||this.item.label,this);var n=document.getElementById(this.id);this.destroy(),this.el=gform.types[this.type].create.call(this),n.parentNode.replaceChild(this.el,n),gform.types[this.type].initialize.call(this),e||this.owner.pub(["change:"+this.name,"change"],this)},render:function(){return this.options=gform.options.call(this,this,this.value),gform.render("select",this)},set:function(t){this.el.querySelector("select").value=t,_.each(this.options.options,function(e,n){e.value!=t&&parseInt(e.value)!=parseInt(t)||(this.el.querySelector('[name="'+this.name+'"]').selectedIndex=n)}.bind(this)),this.el.querySelector("input[type=text]").value=(_.find(this.options,{value:t})||{label:""}).label}}),gform.types.color=_.extend({},gform.types.input,{defaults:{pre:'<i style="display: block;width:20px;height:20px;margin: 0 -5px;"></i>',type:"text"},initialize:function(){this.onchangeEvent=function(){this.value=this.get(),this.owner.pub(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this),this.el.addEventListener("input",this.onchangeEvent.bind(null,!0)),$(this.el.querySelector('input[name="'+this.name+'"]')).attr("type","text"),this.el.querySelector("i").style.backgroundColor=this.get(),$(this.el.querySelector('input[name="'+this.name+'"]')).colorpicker({format:"hex"}).on("changeColor",function(t){this.el.querySelector("i").style.backgroundColor=this.get(),this.owner.pub("change",this)}.bind(this))}}),gform.types.address=_.extend({},gform.types.input,gform.types.section,{defaults:{fields:[{type:"text",name:"street",label:"Street Address",validate:[{type:"length",max:"255"}]},{type:"text",name:"line2",label:"Address line 2",validate:[{type:"length",max:"150"}]},{type:"text",name:"city",label:"City",validate:[{type:"length",max:"255"}],columns:6},{type:"text",name:"state",label:"State/Province/Region",validate:[{type:"length",max:"255"}],columns:6},{type:"text",name:"zip",label:"Postal/Zip Code",validate:[{type:"length",max:"15"}],columns:6},{type:"select",name:"country",options:"../data/countries.json",format:{label:"{{name}}",value:"{{code}}"},label:"Country",validate:[{type:"length",max:"15"}],columns:6}]}}),gform.types.datetime=_.extend({},gform.types.input,{defaults:{format:{input:"MM/DD/YYYY h:mm A"}},initialize:function(){this.onchangeEvent=function(){this.value=this.get(),this.owner.pub(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this);var t=$(this.el.querySelector('input[name="'+this.name+'"]'));t.attr("type","text"),t.datetimepicker({format:this.format.input}),t.on("dp.change",this.onchangeEvent.bind(null,!0))}}),gform.types.date=_.extend({},gform.types.datetime,{defaults:{format:{input:"MM/DD/YYYY"}}}),gform.types.time=_.extend({},gform.types.datetime,{defaults:{format:{input:"h:mm A"}}});
