var gform=function(t,e){"use strict";this.methods=t.methods||{},this.eventBus=new gform.eventBus({owner:"form",item:"field",handlers:t.events||{}},this),this.on=this.eventBus.on,this.trigger=this.eventBus.dispatch,this.dispatch=this.trigger,this.on("reset",function(t){t.form.set(t.form.options.data)}),this.on("clear",function(t){t.form.set()}),"object"==typeof t.collections?this.collections=t.collections:this.collections=gform.collections,this.options=_.assignIn({fields:[],legend:"",strict:!0,default:gform.default,data:"search",columns:gform.columns,name:gform.getUID()},this.opts,t),this.options.fields=this.options.fields.concat(this.options.actions||[{type:"cancel"},{type:"save"}]),"string"==typeof this.options.data&&(this.options.data=window.location[this.options.data].substr(1).split("&").map(function(t){return t.split("=")}).reduce(function(t,e){return t[e[0]]=decodeURIComponent(e[1]),t},{})),this.options.sections&&_.each(_.filter(this.options.fields,{type:"fieldset"}),function(t,e){return t.index=e,t.section=!0,t.id=gform.getUID(),t}),this.el=e||t.el,"string"==typeof this.el?(this.selector=this.el+"",this.el=document.querySelector(this.el)):"object"==typeof this.el?this.el:e="",this.trigger("initialize");var i=function(){void 0===this.el&&(this.options.renderer="modal",this.el=gform.create(gform.render(this.options.template||"modal_container",this.options)),gform.addClass(this.el,"active"),this.on("close",function(t){t.form.modal("hide")}),this.on("save",function(t){gform.removeClass(t.form.el,"active")}),this.el.querySelector(".close").addEventListener("click",function(t){this.trigger("cancel",this)}.bind(this)),document.addEventListener("keyup",function(t){"Escape"===t.key&&this.trigger("cancel",this)}.bind(this))),this.options.clear&&"modal"!=this.options.renderer&&(this.el.innerHTML=gform.render(this.options.sections+"_container",this.options)),this.container=this.el.querySelector("form")||this.el,this.rows={},this.fields=_.map(this.options.fields,gform.createField.bind(this,this,this.options.data||{},null,null)),_.each(this.fields,gform.inflate.bind(this,this.options.data||{})),gform.each.call(this,function(t){t.owner.trigger("change:"+t.name,t)}),this.options.private||(gform.instances[this.options.name]=this)};this.restore=i.bind(this),this.get=this.toJSON=gform.toJSON.bind(this),this.toString=gform.toString.bind(this),this.reflow=gform.reflow.bind(this),this.find=gform.find.bind(this),this.filter=gform.filter.bind(this),this.set=function(t,e){"string"==typeof t&&this.find(t).set(e),"object"==typeof t&&_.each(t,function(t,e){var i=this.find(e);void 0!==i&&i.set(t)}.bind(this)),null==t&&gform.each.call(this,function(t){t.set("")})}.bind(this),this.isActive=!0,this.destroy=function(){this.isActive=!1,this.trigger(["close","destroy"]),this.el.innerHTML="",delete gform.instances[this.options.name],this.trigger("destroyed")},i.call(this);var n=this.el.querySelector("ul.tabs");return null!==n&&n.addEventListener("click",function(t){"LI"==t.target.nodeName&&(t.preventDefault(),gform.removeClass(this.el.querySelector("ul.tabs .active"),"active"),gform.removeClass(this.el.querySelector(".tab-pane.active"),"active"),gform.addClass(t.target,"active"),gform.addClass(this.el.querySelector(t.target.parentElement.attributes.href.value),"active"))}.bind(this)),(this.options.autoFocus||gform.options.autoFocus)&&this.fields.length&&gform.types[this.fields[0].type].focus.call(this.fields[0]),this.el.addEventListener("click",function(t){var e;if(t.target.dataset.id&&(e=gform.findByID.call(this,t.target.dataset.id)),t.target.classList.contains("gform-add")){t.stopPropagation();var i=_.countBy(e.parent.fields,{name:e.name}).true;if(e.editable&&i<(e.array.max||5)){var n=_.findIndex(e.parent.fields,{id:e.id}),s={};s[e.name]=[e.item.value||null];var o=gform.createField.call(this,e.parent,s,e.el,null,e.item,null,null,i);e.parent.fields.splice(n+1,0,o),e.parent.reflow(),_.each(_.filter(e.parent.fields,{name:e.name}),function(t,e){t.index=e,gform.types[t.type].setLabel.call(t)}),gform.each.call(e.owner,function(t){t.owner.trigger("change:"+t.name,t)}),gform.types[o.type].focus.call(o),e.owner.trigger(["change","change:"+e.name,"create","create:"+e.name,"inserted","inserted:"+e.name],e),i++}var r=function(t,e){gform.toggleClass(e,"hidden",t)};_.each(e.parent.el.querySelectorAll('[data-name="'+e.name+'"] .gform-add'),r.bind(null,i>=(e.array.max||5))),_.each(e.parent.el.querySelectorAll('[data-name="'+e.name+'"] .gform-minus'),r.bind(null,!(i>(e.array.min||1))))}t.target.classList.contains("gform-minus")&&(t.stopPropagation(),i=_.countBy(e.parent.fields,{name:e.name}).true,e.editable&&i>(e.array.min||1)?(n=_.findIndex(e.parent.fields,{id:e.id}),e.parent.fields.splice(n,1),e.parent.reflow(),e.target?this.container.querySelector(e.target).removeChild(e.el):_.each(_.filter(e.parent.fields,{name:e.name}),function(t,e){t.index=e,gform.types[t.type].setLabel.call(t)}),e.owner.trigger(["change","change:"+e.name,"removed","removed:"+e.name],e),i--):e.editable&&e.set(null),r=function(t,e){gform.toggleClass(e,"hidden",t)},_.each(e.parent.el.querySelectorAll('[data-name="'+e.name+'"] .gform-add'),r.bind(null,i>=(e.array.max||5))),_.each(e.parent.el.querySelectorAll('[data-name="'+e.name+'"] .gform-minus'),r.bind(null,!(i>(e.array.min||1)))))}.bind(this)),this};gform.each=function(t){_.each(this.fields,function(e){t(e),void 0!==e.fields&&gform.each.call(e,t)})},gform.find=function(t){var e,i;if("string"==typeof t)e=t.split("."),i=_.find(this.fields,{name:e.shift()});else if("number"==typeof t);else if("object"==typeof t)return gform.filter.call(this,t)[0]||!1;return void 0!==i?void 0!==i.find?i.name==t||"number"==typeof t?i:i.find(e.join(".")):i:void 0!==this.parent&&"function"==typeof this.parent.find?this.parent.find(t):void 0},gform.findByID=function(t){return gform.filter.call(this,{id:t})[0]||!1},gform.filter=function(t){var e=[];return _.each(this.fields,function(i){_.isMatch(i,t)&&e.push(i),void 0!==i.fields&&(e=e.concat(gform.filter.call(i,t)))}),e},gform.toJSON=function(t){if("string"==typeof t&&t.length>0)return t=t.split("."),_.find(this.fields,{name:t.shift()}).get(t.join("."));var e={};return _.each(this.fields,function(t){t.parsable&&(t.array?(e[t.name]=e[t.name]||[],e[t.name].push(t.get())):e[t.name]=t.get())}.bind(this)),e},gform.toString=function(t){if("string"==typeof t&&t.length>0)return t=t.split("."),_.find(this.fields,{name:t.shift()}).toString(t.join("."));var e="";return _.each(this.fields,function(t){var i=t.toString();e+=i}),e},gform.m=function(t,e,i,n){function s(t,e){return t=t[(e=e.pop?e:e.split(".")).shift()]||"",0 in e?s(t,e):t}var o=gform.m,r="";e=_.isArray(e)?e:e?[e]:[],e=n?0 in e?[]:[1]:e;for(n=0;n<e.length;n++){var l,a="",h=0,c="object"==typeof e[n]?e[n]:{};(c=_.assign({},i,c))[""]={"":e[n]},t.replace(/([\s\S]*?)({{((\/)|(\^)|#)(.*?)}}|$)/g,function(t,e,i,n,u,f,d){h?a+=h&&!u||1<h?t:e:(r+=e.replace(/{{{(.*?)}}}|{{(!?)(&?)(>?)(.*?)}}/g,function(t,e,i,n,r,l){return e?s(c,e):n?s(c,l):r?o(s(c,l),c):i?"":new Option(s(c,l)).innerHTML}),l=f),u?--h||(d=s(c,d),r=/^f/.test(typeof d)?r+d.call(c,a,function(t){return o(t,c)}):r+o(a,d,c,l),a=""):++h})}return r},gform.reflow=function(){_.each(this.rows,function(t,e){this.container.removeChild(t.ref),delete this.rows[e]}.bind(this)),_.each(this.fields,function(t){if(!t.target&&t.columns>0){var e,i=(t.parent||t.owner).container.querySelectorAll("form > ."+t.owner.options.rowClass+",fieldset > ."+t.owner.options.rowClass);if(void 0!==(n=(i[i.length-1]||{}).id)&&(e=(t.parent||t.owner).rows[n]),void 0===e||e.used+parseInt(t.columns,10)+parseInt(t.offset,10)>t.owner.options.columns||1==t.row){var n=gform.getUID();(e={}).used=0,e.ref=document.createElement("div"),e.ref.setAttribute("id",n),e.ref.setAttribute("class",t.owner.options.rowClass),e.ref.setAttribute("style","margin-bottom:0;"),(t.parent||t.owner).rows[n]=e,(t.parent||t.owner).container.appendChild(e.ref)}e.used+=parseInt(t.columns,10),e.used+=parseInt(t.offset,10),e.ref.appendChild(t.el),t.row=n}})},gform.instances={},gform.inflate=function(t,e,i,n){var s=n;e.array&&(s=_.uniqBy(s,"name"));var o=_.findLast(s,{name:s[i].name});if(!o.array&&o.fields&&_.each(o.fields,gform.inflate.bind(this,t[o.name]||o.owner.options.data[o.name]||{})),o.array){var r=o.array.min||0;"object"!=typeof t[o.name]&&"object"==typeof o.owner.options.data[o.name]&&(t=o.owner.options.data),"object"==typeof t[o.name]&&t[o.name].length>1&&t[o.name].length>r&&(r=t[o.name].length);for(var l=1;l<r;l++){var a=gform.createField.call(this,o.parent,t,o.el,l,o.item,null,null,l);o.parent.fields.splice(_.findIndex(o.parent.fields,{id:o.id})+1,0,a),o=a}var h=function(t,e){gform.toggleClass(e,"hidden",t)};_.each(document.body.querySelectorAll('[data-name="'+o.name+'"] .gform-add'),h.bind(null,r>=(o.array.max||5))),_.each(document.body.querySelectorAll('[data-name="'+o.name+'"] .gform-minus'),h.bind(null,!(r>(o.array.min||1))))}},gform.normalizeField=function(t,e){e=e||null,t.type=t.type||this.options.default.type||"text";var i=_.assignIn({name:(gform.renderString(t.label||t.title)||"").toLowerCase().split(" ").join("_"),id:gform.getUID(),label:t.legend||t.title||(gform.types[t.type]||gform.types.text).defaults.label||t.name,validate:[],valid:!0,parsable:!0,visible:!0,editable:!0,parent:e,array:!1,columns:this.options.columns||gform.columns,offset:0,ischild:!(e instanceof gform)},this.opts,gform.default,this.options.default,(gform.types[t.type]||gform.types.text).defaults,t);return""==i.name&&(i.name=i.id),i.item=_.extend(t,{}),i},gform.createField=function(t,e,i,n,s,o,r,l){var a=gform.normalizeField.call(this,s,t);if(a.owner=this,a.columns>this.options.columns&&(a.columns=this.options.columns),this.options.strict?a.array&&"object"==typeof(e[a.name]||a.owner.options.data[a.name])?a.value=e[a.name]||{}:a.value=e[a.name]||a.value:a.array&&"object"==typeof(e[a.name]||a.owner.options.data[a.name])?a.value=(e[a.name]||a.owner.options.data[a.name])[n||0]||{}:a.value=e[a.name]||a.owner.options.data[a.name]||a.value,0!==a.item.value?a.array&&"object"==typeof e[a.name]?a.value=e[a.name][n||0]:"function"==typeof a.item.value?(a.valueFunc=a.item.value,a.derivedValue=function(){return a.valueFunc.call(a,a.owner.toJSON())},a.item.value=a.item.value=a.derivedValue(),a.owner.on("change",function(){this.set.call(this,this.derivedValue())}.bind(a))):a.value=e[a.name]||a.value||"":a.value=0,a.index=a.index||l||0,a.label=gform.renderString(a.item.label||a.label,a),a.satisfied=a.satisfied||gform.types[a.type].satisfied.bind(a),a.update=gform.types[a.type].update.bind(a),a.destroy=gform.types[a.type].destroy.bind(a),a.active=function(){return this.parent.active()&&this.editable&&this.parsable&&this.visible},a.set=function(t,e){this.value==t&&null!=t||gform.types[this.type].set.call(this,t)||(this.value=t,e||this.owner.trigger(["change:"+this.name,"change"],this))}.bind(a),a.get=a.get||gform.types[a.type].get.bind(a),a.toString=gform.types[a.type].toString.bind(a),a.render=a.render||gform.types[a.type].render.bind(a),a.el=gform.types[a.type].create.call(a),a.container=a.el.querySelector("fieldset")||a.el||null,void 0!==gform.types[a.type].reflow&&(a.reflow=gform.types[a.type].reflow.bind(a)||null),void 0!==gform.types[a.type].find&&(a.find=gform.types[a.type].find.bind(a)||null),a.target||a.section||!this.options.clear&&!a.isChild)a.target||(a.target='[name="'+a.name+'"],[data-inline="'+a.name+'"]'),null!=(u=this.el.querySelector(a.target))?u.appendChild(a.el):a.section&&a.owner.el.querySelector("."+a.owner.options.sections+"-content").appendChild(a.el);else if(a.columns>0){var h,c=(a.parent||a.owner).container.querySelectorAll("form > ."+a.owner.options.rowClass+",fieldset > ."+a.owner.options.rowClass);if(void 0!==(u=(c[c.length-1]||{}).id)&&(h=(a.parent||a.owner).rows[u]),void 0===h||h.used+parseInt(a.columns,10)+parseInt(a.offset,10)>this.options.columns||1==a.row){var u=gform.getUID();(h={}).used=0,h.ref=document.createElement("div"),h.ref.setAttribute("id",u),h.ref.setAttribute("class",a.owner.options.rowClass),h.ref.setAttribute("style","margin-bottom:0;"),(a.parent||a.owner).rows[u]=h,(a.parent||a.owner).container.appendChild(h.ref)}h.used+=parseInt(a.columns,10),h.used+=parseInt(a.offset,10),h.ref.appendChild(a.el),a.row=u}if(gform.types[a.type].initialize.call(a),a.fields){var f;f=a.array&&"object"==typeof(e[a.name]||a.owner.options.data[a.name])?(e[a.name]||a.owner.options.data[a.name])[n||0]||{}:e[a.name]||a.owner.options.data[a.name]||{},a.fields=_.map(a.fields,gform.createField.bind(this,a,f,null,null)),a.array&&(_.each(a.fields,gform.inflate.bind(this,f)),a.reflow())}return gform.processConditions.call(a,a.show,function(t){this.el.style.display=t?"block":"none",this.visible=t}),gform.processConditions.call(a,a.edit,function(t){this.editable=t,gform.types[this.type].edit.call(this,this.editable)}),gform.processConditions.call(a,a.parse||a.show,function(t){this.parsable=t}),a.required&&gform.processConditions.call(a,a.required,function(t){this.required!==t&&this.update({required:t})}),a},gform.rows={add:function(t){var e=gform.getUID();return cRow={},cRow.used=0,cRow.ref=document.createElement("div"),cRow.ref.setAttribute("id",e),cRow.ref.setAttribute("class",this.options.rowClass),cRow.ref.setAttribute("style","margin-bottom:0;"),t.rows[e]=cRow,t.container.appendChild(cRow.ref),cRow},remove:function(){}},gform.ajax=function(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){4===e.readyState&&(200===e.status?t.success(JSON.parse(e.responseText)):(console.log(e.responseText),t.error(e.responseText)))},e.open(t.verb||"GET",t.path),e.send()},gform.default={},gform.options={autoFocus:!0},gform.prototype.opts={clear:!0,sections:"",suffix:":",rowClass:"row",requiredText:'<span style="color:red">*</span>'},gform.eventBus=function(t,e){this.options=t||{owner:"form",item:"field"},this.owner=e||this,this.handlers=t.handlers||{},_.each(this.handlers,function(t,e,i){"function"==typeof t?i[e]=[t]:"string"==typeof t&&("function"==typeof this[t]?i[e]=[this[t]]:"function"==typeof this.owner[t]?i[e]=[this.owner[t]]:void 0!==this.owner.methods&&"function"==typeof this.owner.methods[t]?i[e]=[this.owner.methods[t]]:"function"==typeof window[t]?i[e]=[window[t]]:i[e]=null)}.bind(this)),this.dispatch=function(t,i,n){(n=n||{})[this.options.owner]=this.owner,void 0!==i&&(n[this.options.item]=i),n.default=!0,n.continue=!0,n.preventDefault=function(){n.default=!1}.bind(this),n.stopPropagation=function(){n.continue=!1}.bind(this);var s=[];return"string"==typeof t?s.push(t):s=s.concat(t),_.each(s,function(t,i){t.event=i;var s=function(i){n.continue&&i.call(e,t)}.bind(this);_.each(this.handlers[i],s),_.each(this.handlers["*"],s)}.bind(this,n)),n}.bind(this),this.on=function(t,e){var i=t.split(" ");return"object"!=typeof this.handlers[t]&&(this.handlers[t]=[]),_.each(i,function(t){"function"==typeof e?this.handlers[t].push(e):"function"==typeof this[e]&&this.handlers[t].push(this[e])}.bind(this)),this.owner}.bind(this)},gform.mapOptions=function(t,e,i,n){this.collections=n,this.eventBus=new gform.eventBus({owner:"field",item:"option"},this),this.optgroup=_.extend({},t),i=i||0;var s=this.optgroup.format;function o(t){return _.map(t,function(t){if("object"==typeof t&&"optgroup"==t.type)return t.map=new gform.mapOptions(t,e,i,this.collections),t.map.on("*",function(t){this.eventBus.dispatch(t.event)}.bind(this)),t.id=gform.getUID(),gform.processConditions.call(this,t.edit,function(t,e){for(var i=this.el.querySelectorAll('[data-id="'+t+'"]'),n=0;n<i.length;n++)i[n].disabled=!e}.bind(this,t.id)),gform.processConditions.call(this,t.show,function(t,e){for(var i=this.el.querySelectorAll('[data-id="'+t+'"]'),n=0;n<i.length;n++)i[n].hidden=!e}.bind(this,t.id)),i+=t.options.length,t;var n=_.extend({},t);return n.data=t,"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||(n.label=n.value=t),n.index=t.index||""+i,void 0!==s&&(void 0!==s.label&&("string"==typeof s.label?n.label=gform.renderString(s.label,n):"function"==typeof s.label&&(n.label=s.label.call(this.option))),void 0!==s.display&&("string"==typeof s.display?n.display=gform.renderString(s.display,n):"function"==typeof s.display&&(n.display=s.display.call(this.option))),void 0!==s.value&&("string"==typeof s.value?n.value=gform.renderString(s.value,n):"function"==typeof s.value&&(n.value=s.value.call(this,n)))),(n.value==e||e.length&&e.indexOf(n.value)>=0)&&(n.selected=!0),i+=1,n.i=i,n}.bind(this))}switch(this.optgroup.options=this.optgroup.options||[],typeof this.optgroup.options){case"string":this.optgroup.path=this.optgroup.path||this.optgroup.options,this.optgroup.options=[];break;case"function":this.optgroup.action=this.optgroup.options,this.optgroup.options=[]}if(void 0!==this.optgroup.max&&""!==this.optgroup.max)for(var r=this.optgroup.min||0;r<=this.optgroup.max;r+=this.optgroup.step||1)this.optgroup.options.push(""+r);return void 0!==this.optgroup.action&&(this.optgroup.options=this.optgroup.options.concat(o.call(this,this.optgroup.action.call(this)))),_.isArray(this.optgroup.options)&&(this.optgroup.options=o.call(this,this.optgroup.options)),void 0!==this.optgroup.path&&(this.collections.on(this.optgroup.path,function(t){this.optgroup.options=o.call(this.optgroup.map,t.collection),this.eventBus.dispatch("change")}.bind(this)),void 0===this.collections.get(this.optgroup.path)?(this.collections.add(this.optgroup.path,[]),gform.ajax({path:this.optgroup.path,success:function(t){this.collections.update(this.optgroup.path,t)}.bind(this)})):this.optgroup.options=o.call(this.optgroup.map,this.collections.get(this.optgroup.path))),{getobject:function(){return _.map(this.optgroup.options,function(t){return void 0!==t.map?(t.options=t.map.getoptions(),{optgroup:{label:t.label||"",options:t.map.getoptions()}}):t})}.bind(this),getoptions:function(t){var e=[];return _.each(this.optgroup.options,function(t){void 0!==t.map?e=e.concat(t.map.getoptions()):e.push(t)}),void 0!==t?_.find(e,t):e}.bind(this),on:this.eventBus.on,handlers:this.handlers,optgroup:this.optgroup}},gform.collectionManager=function(t){var e=t||{};return this.eventBus=new gform.eventBus({owner:"manager",item:"collection",handlers:{}},this),{add:function(t,i){e[t]=i},get:function(t){return e[t]},update:function(t,i){void 0!==i&&(e[t]=i),this.eventBus.dispatch(t,e[t])}.bind(this),on:this.eventBus.on}},gform.collections=new gform.collectionManager,gform.render=function(t,e){return gform.m(gform.stencils[t||"text"]||gform.stencils.text,_.extend({},gform.stencils,e))},gform.create=function(t){return document.createRange().createContextualFragment(t).firstElementChild},gform.renderString=function(t,e){return gform.m(t||"",e||{})},gform.addClass=function(t,e){t.className=_.chain(t.className).split(/[\s]+/).union(e.split(" ")).join(" ").value()},gform.removeClass=function(t,e){t.className=_.chain(t.className).split(/[\s]+/).difference(e.split(" ")).join(" ").value()},gform.toggleClass=function(t,e,i){i?gform.addClass(t,e):gform.removeClass(t,e)},gform.VERSION="0.0.0.9",gform.i=0,gform.getUID=function(){return"f"+gform.i++},gform.types={input:{defaults:{},setup:function(){gform.types[this.type].setLabel.call(this)},setLabel:function(){var t=gform.renderString((this.format||{title:null}).title||this.item.title||this.item.label||this.label,this);this.required&&(t+=this.requiredText+this.suffix);var e=this.el.querySelector("label");null!==e&&(e.innerHTML=t)},create:function(){var t=document.createElement("span");return t.setAttribute("id",this.id),this.owner.options.clear&&t.setAttribute("class",""+gform.columnClasses[this.columns]),t.innerHTML=this.render(),t},render:function(){return gform.render(this.type,this)},destroy:function(){this.el.removeEventListener("change",this.onchangeEvent),this.el.removeEventListener("input",this.onchangeEvent)},initialize:function(){this.onchangeEvent=function(t){if(this.value=this.get(),null!=this.el.querySelector(".count")){var e=this.value.length;this.limit&&(e+="/"+this.limit),this.el.querySelector(".count").innerHTML=e}gform.types[this.type].setup.call(this),this.owner.trigger(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this),this.input=this.input||!1,this.el.addEventListener("input",this.onchangeEvent.bind(null,!0)),this.el.addEventListener("change",this.onchangeEvent.bind(null,!1))},update:function(t,e){void 0===t||void 0===typeof t.options&&void 0===typeof t.max&&void 0===typeof t.action||void 0===this.mapOptions||(delete this.mapOptions,this.item=_.defaults({},t,this.item),this.options=_.extend([],this.item.options),this.max=this.item.max,this.min=this.item.min,this.path=this.item.path,this.action=this.item.action),"object"==typeof t&&_.extend(t,this),this.label=gform.renderString((t||{}).label||this.item.label,this);var i=this.el;this.destroy(),this.el=gform.types[this.type].create.call(this),i.parentNode.replaceChild(this.el,i),gform.types[this.type].initialize.call(this),this.el.style.display=this.visible?"block":"none",gform.types[this.type].edit.call(this,this.editable),e||this.owner.trigger(["change:"+this.name,"change"],this),"function"==typeof gform.types[this.type].setup&&gform.types[this.type].setup.call(this)},get:function(){return this.el.querySelector('input[name="'+this.name+'"]').value},set:function(t){this.el.querySelector('input[name="'+this.name+'"]').value=t},toString:function(){return"<dt>"+this.label+"</dt> <dd>"+(this.value||"(empty)")+"</dd><hr>"},satisfied:function(t){return null!=t&&""!==t},edit:function(t){this.el.querySelector('[name="'+this.name+'"]').disabled=!t},find:function(){return this},focus:function(){this.el.querySelector('[name="'+this.name+'"]').focus();var t=this.value;this.set(""),this.set(t)}},bool:{defaults:{options:[!1,!0],format:{label:""}},render:function(){return void 0===this.mapOptions&&(this.mapOptions=new gform.mapOptions(this,this.value,0,this.owner.collections),this.mapOptions.on("change",function(){this.options=this.mapOptions.getobject(),this.update()}.bind(this))),this.options=this.mapOptions.getobject(),this.selected=this.value==this.options[1].value,gform.render(this.type,this)},set:function(t){this.selected=t==this.options[1].value,this.el.querySelector('input[name="'+this.name+'"]').checked=this.selected},get:function(){return this.options[this.el.querySelector('input[name="'+this.name+'"]').checked?1:0].value},satisfied:function(t){return t==this.options[1].value}},collection:{defaults:{format:{label:"{{{label}}}",value:"{{{value}}}"}},toString:function(){return this.multiple?this.value.length?_.reduce(this.value,function(t,e){var i=_.find(this.options,{value:e});return void 0!==i&&(t+="<dd>"+i.label+"</dd>"),t}.bind(this),"<dt>"+this.label+"</dt> ")+"<hr>":"<dt>"+this.label+"</dt> <dd>(no selection)</dd><hr>":"<dt>"+this.label+"</dt> <dd>"+((_.find(this.options,{value:this.value})||{label:""}).label||"(no selection)")+"</dd><hr>"},render:function(){return void 0===this.mapOptions&&(this.mapOptions=new gform.mapOptions(this,this.value,0,this.owner.collections),this.mapOptions.on("change",function(){this.options=this.mapOptions.getobject(),this.update()}.bind(this))),this.options=this.mapOptions.getobject(),this.value=this.value||(this.options[0]||{value:""}).value,gform.render(this.type,this)},setup:function(){if(this.multiple&&"undefinded"!=typeof this.limit&&(this.get().length>=this.limit?(this.maxSelected=!0,_.each(this.el.querySelector("select").options,function(t){t.disabled=!t.selected})):this.maxSelected&&(this.maxSelected=!1,_.each(this.el.querySelector("select").options,function(t){t.disabled=!1})),null!=this.el.querySelector(".count"))){var t=this.get().length;this.limit&&(t+="/"+this.limit),this.el.querySelector(".count").innerHTML=t}gform.types[this.type].setLabel.call(this)},initialize:function(){this.el.addEventListener("change",function(){if(this.input=!0,this.value=this.get(),null!=this.el.querySelector(".count")){var t=this.value.length;this.limit&&(t+="/"+this.limit),this.el.querySelector(".count").innerHTML=t}gform.types[this.type].setup.call(this),this.owner.trigger(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this)),this.input=this.input||!1,gform.types[this.type].setup.call(this)},get:function(){var t=this.el.querySelector("select").value;return this.multiple&&(t=_.transform(this.el.querySelector("select").options,function(t,e){e.selected&&t.push(e.value)},[])),t},set:function(t){if(this.el.querySelector("select").value=t,this.multiple){if(_.isArray(t)||(t=[t]),"undefinded"!=typeof this.limit&&t.length>this.limit)return!0;_.each(this.el.querySelector("select").options,function(e){e.selected=t.indexOf(e.value)>=0}.bind(this))}"function"==typeof gform.types[this.type].setup&&gform.types[this.type].setup.call(this)},focus:function(){this.el.querySelector('[name="'+this.name+'"]').focus()}},section:{setLabel:function(){var t=gform.renderString(this.item.label||this.label,this);this.required&&(t+=this.requiredText+this.suffix);var e=this.el.querySelector("legend");null!==e&&(e.innerHTML=t)},create:function(){var t=document.createRange().createContextualFragment(this.render()).firstElementChild;return gform.addClass(t,gform.columnClasses[this.columns]),t},initialize:function(){this.rows={}},render:function(){return this.section?gform.render(this.owner.options.sections+"_fieldset",this):gform.render("_fieldset",this)},update:function(t,e){"object"==typeof t&&_.extend(this.item,t),this.label=gform.renderString((t||{}).label||this.item.label,this);var i=this.el;this.destroy(),this.el=gform.types[this.type].create.call(this),i.parentNode.replaceChild(this.el,i),gform.types[this.type].initialize.call(this),this.el.style.display=this.visible?"block":"none",gform.types[this.type].edit.call(this,this.editable),this.container=this.el.querySelector("fieldset")||this.el||null,this.reflow(),e||this.owner.trigger(["change:"+this.name,"change"],this)},get:function(t){return gform.toJSON.call(this,t)},toString:function(t){return"<h4>"+this.label+'</h4><hr><dl style="margin-left:10px">'+gform.toString.call(this,t)+"</dl>"},set:function(t){null==t||""==t?gform.each.call(this,function(t){t.set("")}):_.each(t,function(t,e){var i=this.find(e);void 0!==i&&i.set(t)}.bind(this))},find:function(t){return gform.find.call(this,t)},reflow:function(){gform.reflow.call(this)},focus:function(){this.fields.length&&gform.types[this.fields[0].type].focus.call(this.fields[0])}},button:{toString:function(){return""},defaults:{parsable:!1,columns:2,target:".gform-footer"},create:function(){var t=document.createRange().createContextualFragment(this.render()).firstElementChild;return t.setAttribute("id",this.id),t},initialize:function(){this.action=this.action||(this.label||"").toLowerCase().split(" ").join("_"),this.onclickEvent=function(){this.editable&&this.owner.trigger(this.action,this)}.bind(this),this.el.addEventListener("click",this.onclickEvent)},render:function(){return gform.render("button",this)},satisfied:function(t){return this.editable&&this.visible},update:function(t,e){"object"==typeof t&&_.extend(this,this.item,t),this.label=gform.renderString((t||{}).label||this.item.label,this);var i=this.el;this.destroy(),this.el=gform.types[this.type].create.call(this),i.parentNode.replaceChild(this.el,i),gform.types[this.type].initialize.call(this),this.el.style.display=this.visible?"block":"none",gform.types[this.type].edit.call(this,this.editable)},destroy:function(){this.el.removeEventListener("click",this.onclickEvent)},get:function(t){return null},set:function(t){},edit:function(t){this.editable=t,this.el.disabled=!t,gform.toggleClass(this.el,"disabled",!t)},focus:function(){this.el.focus()}}},gform.types.text=gform.types.password=gform.types.number=gform.types.color=gform.types.input,gform.types.hidden=_.extend({},gform.types.input,{defaults:{columns:!1},toString:function(){return""}}),gform.types.output=_.extend({},gform.types.input,{toString:function(){return""},render:function(){return this.display=gform.renderString((this.format||{}).value||"{{{value}}}",this),gform.render(this.type,this)},get:function(t){return this.value},set:function(t){this.value=t,this.display=gform.renderString((this.format||{}).value||"{{{value}}}",this),this.el.querySelector("output").innerHTML=this.display}}),gform.types.email=_.extend({},gform.types.input,{defaults:{validate:[{type:"valid_email"}]}}),gform.types.textarea=_.extend({},gform.types.input,{set:function(t){this.el.querySelector('textarea[name="'+this.name+'"]').value=t},get:function(){return this.el.querySelector('textarea[name="'+this.name+'"]').value}}),gform.types.switch=gform.types.checkbox=_.extend({},gform.types.input,gform.types.bool,{default:{format:{label:""}}}),gform.types.fieldset=_.extend({},gform.types.input,gform.types.section),gform.types.select=_.extend({},gform.types.input,gform.types.collection,{render:function(){return void 0===this.mapOptions&&(this.mapOptions=new gform.mapOptions(this,this.value,0,this.owner.collections),this.mapOptions.on("change",function(){this.options=this.mapOptions.getobject(),this.update()}.bind(this))),this.options=this.mapOptions.getobject(),this.value=this.value||(this.options[0]||{value:""}).value,"string"==typeof this.placeholder&&this.options.unshift({label:this.placeholder,value:"",editable:!1,visible:!1,selected:!0}),gform.render(this.type,this)}}),gform.types.range=_.extend({},gform.types.input,gform.types.collection,{get:function(){return(this.el.querySelector("[type=range]")||{value:""}).value},set:function(t){this.el.querySelector("[type=range]").value=t}}),gform.types.radio=_.extend({},gform.types.input,gform.types.collection,{setup:function(){if(this.multiple&&"undefinded"!=typeof this.limit&&(this.get().length>=this.limit?(this.maxSelected=!0,_.each(this.el.querySelectorAll("[type=checkbox]"),function(t){t.disabled=!t.checked})):this.maxSelected&&(this.maxSelected=!1,_.each(this.el.querySelectorAll("[type=checkbox]"),function(t){t.disabled=!1})),null!=this.el.querySelector(".count"))){var t=this.get().length;this.limit&&(t+="/"+this.limit),this.el.querySelector(".count").innerHTML=t}gform.types[this.type].setLabel.call(this)},get:function(){return this.multiple?_.transform(this.el.querySelectorAll('[type="checkbox"]:checked'),function(t,e){t.push(e.value)},[]):(this.el.querySelector('[type="radio"]:checked')||{value:""}).value},set:function(t){if(this.multiple){if(_.isArray(t)||(t=[t]),"undefinded"!=typeof this.limit&&t.length>this.limit)return!0;_.each(this.el.querySelectorAll("[type=checkbox]"),function(e){e.checked=t.indexOf(e.value)>=0}.bind(this))}else{var e=this.el.querySelector('[value="'+t+'"]');null!==e&&(e.checked="checked")}"function"==typeof gform.types[this.type].setup&&gform.types[this.type].setup.call(this)},edit:function(t){_.each(this.el.querySelectorAll("input"),function(e){e.disabled=!t})},focus:function(){this.el.querySelector('[type="radio"],[type="checkbox"]').focus()}}),gform.types.scale=_.extend({},gform.types.radio),gform.types.checkboxes=_.extend({},gform.types.radio,{multiple:!0}),gform.types.grid=_.extend({},gform.types.input,gform.types.collection,{render:function(){return void 0===this.mapOptions&&(this.mapOptions=new gform.mapOptions(this,this.value,0,this.owner.collections),this.mapOptions.on("change",function(){this.options=this.mapOptions.getobject(),this.update()}.bind(this))),this.options=this.mapOptions.getobject(),this.fields=_.map(this.fields,function(t){return _.assignIn({name:(gform.renderString(t.label)||"").toLowerCase().split(" ").join("_"),id:gform.getUID(),label:t.name},t)}),gform.render(this.type,this)},setup:function(){this.multiple&&"undefinded"!=typeof this.limit&&_.each(this.fields,function(t){(this.value[t.name]||[]).length>=this.limit?(t.maxSelected=!0,_.each(this.el.querySelectorAll('[type=checkbox][name="'+t.id+'"]'),function(t){t.disabled=!t.checked})):t.maxSelected&&(t.maxSelected=!1,_.each(this.el.querySelectorAll('[type=checkbox][name="'+t.id+'"]'),function(t){t.disabled=!1}))}.bind(this)),gform.types[this.type].setLabel.call(this)},initialize:function(){this.el.addEventListener("change",function(){this.value=this.get(),gform.types[this.type].setup.call(this),this.owner.trigger(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this)),gform.types[this.type].setup.call(this),this.rows={},this.fields=_.map(this.fields,function(t){return t.type="hidden",t})},get:function(){return this.multiple?_.transform(this.fields,function(t,e){t[e.name]=_.transform(this.el.querySelectorAll('[type="checkbox"][name="'+e.id+'"]:checked'),function(t,e){t.push(e.value)},[])}.bind(this),{}):_.transform(this.fields,function(t,e){t[e.name]=(this.el.querySelector('[type="radio"][name="'+e.id+'"]:checked')||{value:""}).value}.bind(this),{})},set:function(t){this.multiple?_.each(this.fields,function(t,e){if("undefinded"!=typeof this.limit&&null!=t&&t.length>this.limit)return!0;_.each(this.el.querySelectorAll('[name="'+e.id+'"][type=checkbox]'),function(t,e){e.checked=t.indexOf(e.value)>=0}.bind(this,t[e.name]))}.bind(this,t)):_.each(this.fields,function(e){var i=this.querySelector('[name="'+e.id+'"][value="'+t[e.name]+'"]');null!==i&&(i.checked="checked")}.bind(this)),this.value=t,gform.types.grid.setup.call(this)},focus:function(){this.el.querySelector('[name="'+this.fields[0].id+'"]').focus()}}),gform.processConditions=function(t,e){if("string"==typeof t&&("show"!==t&&"edit"!==t&&"parse"!==t||(t=this.item[t])),"boolean"==typeof t&&e.call(this,t),"function"==typeof t&&e.call(this,t.call(this)),"object"==typeof t){var i=function(t,e){e.call(this,gform._rules.call(this,t))}.bind(this,t,e);gform._subscribeByName.call(this,t,i)}return!0},gform._subscribeByName=function(t,e){for(var i in t)void 0!==t[i].name?this.owner.on("change:"+t[i].name,e):"object"==typeof t[i].conditions&&gform._subscribeByName.call(this,t[i].conditions,e)},gform._rules=function(t,e){return e=e||"and",_.reduce(t,function(t,i){var n;return void 0!==i.conditions?(n=gform._rules.call(this,i.conditions,i.op),console.log(n)):n=gform.conditions[i.type](this,i),"or"==e?t||n:t&&n}.bind(this),"and"==e)},gform.conditions={requires:function(t,e){return t.parent.find(e.name).satisfied()},not_matches:function(t,e){var i=e.value,n=(t.parent.find(e.name)||{value:""}).value;return"object"==typeof i&&null!==n?-1==i.indexOf(n):i!==n},test:function(t,e){return e.test.call(this,t,e)},contains:function(t,e){var i=e.value,n=(t.parent.find(e.name)||{value:""}).value;return"object"==typeof i&&null!==n?_.intersection(i,n).length>0:void 0!==n&&-1!==n.indexOf(i)},matches:function(t,e){var i=e.value,n=(t.parent.find(e.name)||{value:""}).value;return"object"==typeof i&&null!==n?-1!==i.indexOf(n):i==n}},gform.prototype.errors={},gform.prototype.validate=function(t){return this.valid=!0,_.each(this.fields,gform.validateItem.bind(null,t)),this.valid?this.trigger("valid"):this.trigger("invalid",{errors:this.errors}),this.trigger("validation"),this.valid},gform.handleError=gform.update,gform.validateItem=function(t,e){if(t||!e.valid||e.required||e.satisfied()){var i=e.get();if(e.valid=!0,e.errors="",e.parsable&&"object"==typeof e.validate){var n=gform.validation.call(e,e.validate);if(e.required){var s=!e.satisfied(e.get())&&"{{label}} is required";s&&n.push(gform.renderString(e.required.message||s,{label:e.label,value:i,args:e.required}))}n=_.compact(n),(void 0===e.display||e.visible)&&(e.valid=!n.length,e.errors=n.join("<br>"),gform.handleError(e))}}e.parsable&&void 0!==e.fields&&_.each(e.fields,gform.validateItem.bind(null,t)),e.errors?e.owner.trigger("invalid:"+e.name,{errors:e.errors}):e.owner.trigger("valid:"+e.name),e.owner.errors[e.name]=e.errors,e.owner.valid=e.valid&&e.owner.valid},gform.validation=function(t,e){e=e||"and";var i=this.get(),n=_.map(t,function(t,e){if("string"==typeof e.type){if(void 0===e.conditions||gform._rules.call(this,e.conditions)){var n=t[e.type].call(this,i,e);if(n)return gform.renderString(e.message||n,{label:this.label,value:i,args:e})}}else if(void 0!==e.tests)return gform.validation.call(this,e.tests,e.op).join("<br>")}.bind(this,gform.validations));return"and"==e||_.compact(n).length==t.length?n:[]},gform.regex={numeric:/^[0-9]+$/,decimal:/^\-?[0-9]*\.?[0-9]+$/,url:/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,date:/^(0[1-9]|1[0-2])\/(0[1-9]|1\d|2\d|3[01])\/(19|20)\d{2}$/,email:/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,6}$/i},gform.validations={required:function(t){return!this.satisfied(t)&&"{{label}} is required"},pattern:function(t,e){var i=e.regex;return"string"==typeof i&&(i=gform.regex[i]),!i.pattern(t)&&""!==t&&e.message},custom:function(t,e){return e.test.call(this,t,e)},matches:function(t,e){var i=this.parent.find(e.name);return void 0===i?"Matching field not defined":(e.label=i.label,e.value=i.get(),t!=e.value&&'"{{label}}" does not match the "{{args.label}}" field')},date:function(t){return!gform.regex.date.test(t)&&""!==t&&"{{label}} should be in the format MM/DD/YYYY"},valid_url:function(t){return!gform.regex.url.test(t)&&""!==t&&"{{label}} must contain a valid Url"},valid_email:function(t){return!gform.regex.email.test(t)&&""!==t&&"{{label}} must contain a valid email address"},length:function(t,e){return gform.regex.numeric.test(e.max)||gform.regex.numeric.test(e.min)?"number"==typeof e.max&&"number"==typeof e.min&&e.min==e.max?e.min!=t.length&&"{{label}} must be exactly "+e.min+" characters in length":"number"==typeof e.max&&t.length>e.max?"{{label}} must not exceed "+e.max+" characters in length":"number"==typeof e.min&&t.length>0&&t.length<e.min&&"{{label}} must be at least "+e.min+" characters in length":"Invalid length requirement"},numeric:function(t,e){return gform.regex.decimal.test(t)||""===t?"number"==typeof e.min&&parseFloat(t)<parseFloat(e.min)?"{{label}} must contain a number greater than {{args.min}}":"number"==typeof e.max&&parseFloat(t)>parseFloat(e.max)?"{{label}} must contain a number less than {{args.max}}":void 0:"{{label}} must contain only numbers"}};
gform.stencils={_container:'<form id="{{name}}" {{^autocomplete}}autocomplete="false"{{/autocomplete}} name="{{name}}" class="gform {{modifiers}}{{#options.horizontal}} form-horizontal{{/options.horizontal}} " {{#action}}action="{{action}}"{{/action}} onsubmit="return false;" {{#method}}method="{{method}}"{{/method}}>{{^legendTarget}}{{#legend}}<legend>{{{legend}}}</legend>{{/legend}}{{/legendTarget}}</form><div class="gform-footer row"></div>',text:'<div class="row clearfix form-group {{modifiers}} data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12">{{/inline}}\n\t{{^inline}}<div class="col-md-8">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t<div class="col-md-12">\n\t{{/label}}\n\t\t{{#pre}}<div class="input-group col-xs-12"><span class="input-group-addon">{{{pre}}}</span>{{/pre}}\n    {{^pre}}{{#post}}<div class="input-group">{{/post}}{{/pre}}\n\t\t<input {{^autocomplete}}autocomplete="off"{{/autocomplete}} class="form-control" {{^editable}}readonly disabled{{/editable}} {{#limit}}maxlength="{{limit}}"{{/limit}}{{#min}} min="{{min}}"{{/min}}{{#max}} max="{{max}}"{{/max}} {{#step}} step="{{step}}"{{/step}} placeholder="{{placeholder}}" type="{{elType}}{{^elType}}{{type}}{{/elType}}" name="{{name}}" id="{{name}}" value="{{value}}" />\n\t\t{{#post}}<span class="input-group-addon">{{{post}}}</span></div>{{/post}}\n    {{^post}}{{#pre}}</div>{{/pre}}{{/post}}\n\t\t{{#limit}}<small class="count text-muted" style="display:block;text-align:right">0/{{limit}}</small>{{/limit}}\n\n\t\t{{>_addons}}\n\t\t{{>_actions}}\n\t</div>\n</div>',output:'\n<div class="row">\n<div>\n\t\t{{>_label}}\n\t\t\n\t<div class="col-xs-12">\n    <output name="{{name}}" id="{{id}}">{{{display}}}</output>\n    {{>_error}}\n\t\t{{>_addons}}\n\t\t{{>_actions}} \n\t\t</div>\n    </div>\n    </div>\n',grid:'\n<fieldset id="{{id}}" name="{{name}}" class="row"  style="margin-bottom:20px">\n\n    {{>_label}}\n\t\t<div class="col-xs-12">\n    <table class="table table-striped" style="margin-bottom:0">\n    <thead>\n        <tr>\n            <th></th>\n            {{#options}}\n            <th><label>{{label}}</label></th>\n            {{/options}}\n            \n        </tr>\n    </thead>\n    <tbody>\n    {{#fields}}\n        <tr>\n            <td><label style="font-weight: 500;" for="{{id}}">{{{label}}}</label></td>\n            {{#options}}\n            <td>\n            {{#multiple}}\n                <div><input name="{{id}}" type="checkbox" {{#selected}} checked {{/selected}} value="{{value}}"/>\n            {{/multiple}}\n            {{^multiple}}\n                <input style="margin-right: 5px;" name="{{id}}" {{#selected}} checked=selected {{/selected}}  value="{{value}}" type="radio">\n            {{/multiple}}\n            </td>\n            {{/options}}\n        </tr>\n        {{/fields}}\n    </tbody>\n\t\t</table>\n\t\t\n{{>_addons}}\n{{>_actions}}\n</div>\n\n    </fieldset>\n',switch:'\n<div class="row clearfix {{modifiers}} {{#array}}isArray" data-min="{{multiple.min}}" data-max="{{multiple.max}}{{/array}}" name="{{name}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12" style="margin:0 0 5px">{{/inline}}\n\t{{^inline}}<div class="col-md-8" style="margin:0 0 15px">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t{{#inline}}<div class="col-md-12" style="margin: -10px 0 5px;"">{{/inline}}\n\t{{^inline}}<div class="col-md-8" style="margin: -5px 0 10px">{{/inline}}\n\t{{/label}}\n\t\t<label class="switch">\n\t\t<input name="{{name}}" type="checkbox" {{#selected}} checked {{/selected}} value="{{value}}" id="{{name}}" />\n\t\t<span class="slider round"></span>\n\t\t</label>\n\t{{#post}}<span class="input-group-addon">{{{post}}}</span></div>{{/post}}\n\t\t{{>_addons}}\n\t\t{{>_actions}}\n\t</div>\n</div>',hidden:'<input type="hidden" name="{{name}}" value="{{value}}" />{{>_addons}}',textarea:'<div class="row clearfix form-group {{modifiers}} {{#array}}isArray" data-min="{{array.min}}" data-max="{{array.max}}{{/array}}" name="{{name}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12" {{#advanced}}style="padding:0px 13px"{{/advanced}}>{{/inline}}\n\t{{^inline}}<div class="col-md-8" {{#advanced}}style="padding:0px 13px"{{/advanced}}>{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t<div class="col-md-12" {{#advanced}}style="padding:0px 13px"{{/advanced}}>\n\t{{/label}}\n\t\t<textarea class="form-control"  {{^editable}}readonly disabled{{/editable}} {{#limit}}maxlength="{{limit}}"{{/limit}} style="width:100%;height:auto;min-height:20px" rows="{{rows}}{{^rows}}3{{/rows}}" name="{{name}}" id="{{guid}}" placeholder="{{placeholder}}">{{content}}{{value}}</textarea>\n\t\t{{#limit}}<small class="count text-muted" style="display:block;text-align:right">0/{{limit}}</small>{{/limit}}\n\t\t{{>_addons}}\n\t\t\t{{>_actions}}\n\t</div>\n</div>',select:'<div class="row clearfix form-group {{modifiers}} {{#size}}size={{size}}{{/size}} {{#array}}isArray" data-min="{{array.min}}" data-max="{{array.max}}{{/array}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12">{{/inline}}\n\t{{^inline}}<div class="col-md-8">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t<div class="col-md-12">\n\t{{/label}}\t\t\n\t{{#limit}}<small class="count text-muted" style="display:block;text-align:right">0/{{limit}}</small>{{/limit}}\n\n\t\t{{#pre}}<div class="input-group"><span class="input-group-addon">{{{pre}}}</span>{{/pre}}\n\t\t{{^pre}}{{#post}}<div class="input-group">{{/post}}{{/pre}}\n\t\t\t<select class="form-control test" {{#multiple}}multiple=multiple{{/multiple}} {{#size}}size={{size}}{{/size}}  name="{{name}}{{#multiple}}[]{{/multiple}}" value="{{value}}" id="{{id}}" />\n\t\t\t{{#options}}\n\t\t\t{{^optgroup}}\n\t\t\t<option {{#selected}}selected=\'selected\'{{/selected}} {{^editable}}disabled{{/editable}} {{^visible}}hidden{{/visible}} value="{{value}}">{{{label}}}</option>\n\t\t\t{{/optgroup}}\n\t\t\t{{#optgroup}}\n\t\t\t{{#optgroup.label}}\n\t\t\t<optgroup label="{{label}}" data-id="{{optgroup.id}} {{^editable}}disabled{{/editable}} {{^visible}}hidden{{/visible}}">\n\t\t\t{{/optgroup.label}}\n\t\t\t\t\t{{#options}}\n\t\t\t\t\t<option data-id="{{optgroup.id}}" {{#selected}}selected=\'selected\'{{/selected}} {{^editable}}disabled{{/editable}} {{^visible}}hidden{{/visible}}  value="{{value}}">{{{label}}}</option>\n\t\t\t\t\t{{/options}}\n\t\t\t\t\t{{#optgroup.label}}\n\t\t\t</optgroup>\n\t\t\t{{/optgroup.label}}\n\t\t\t{{/optgroup}}\n\t\t\t{{/options}}\n\t\t\t</select>\n\t\t{{#post}}<span class="input-group-addon">{{{post}}}</span></div>{{/post}}\n\t\t{{^post}}{{#pre}}</div>{{/pre}}{{/post}}\n\t\t{{>_addons}}\n\t\t{{>_actions}}\n\t</div>\n</div>',radio:'<div class="row clearfix form-group {{modifiers}} {{#array}}isArray" data-min="{{multiple.min}}" data-max="{{multiple.max}}{{/array}}" name="{{name}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12">{{/inline}}\n\t{{^inline}}<div class="col-md-8">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t<div class="col-md-12">\n\t{{/label}}\n\t{{#limit}}<small class="count text-muted" style="display:block;text-align:left">0/{{limit}}</small>{{/limit}}\n\n\n\t\t\t{{#options}}\n\t\t\t{{#multiple}}\n\t\t\t<div class="checkbox">\n\t\t\t\t\t<label class="noselect"><input name="{{name}}_{{value}}" type="checkbox" {{#selected}} checked {{/selected}} value="{{value}}"/> {{label}}</label>\n\t\t\t</div>\n\t\t\t{{/multiple}}\n\t\t\t{{^multiple}}\n\t\t\t<div class="radio">\n\t\t\t\t\t<label {{#inline}}class="radio-inline"{{/inline}}><input style="margin-right: 5px;" name="{{id}}" {{#selected}} checked=selected {{/selected}}  value="{{value}}" type="radio"><span class="noselect" style="font-weight:normal">{{{label}}}{{^label}}&nbsp;{{/label}}</span></label>        \n\t\t\t</div>\n\t\t\t{{/multiple}}\n\t\t\t{{/options}}\n\n\t\t{{>_addons}}\n\t\t{{>_actions}}\n\t</div>\n</div>',_fieldset:'<div class="row"><fieldset data-type="fieldset" style="margin-left: 15px;margin-right: -15px;" name="{{name}}" id="{{id}}" class="{{modifiers}}" >\n{{#array}}\n<div data-name="{{name}}" class="btn-group hidden-print actions">\n\t<div data-id="{{id}}" class="btn btn-white gform-minus"><i data-id="{{id}}"  class="fa gform-minus fa-minus text-danger"></i></div>\n\t<div data-id="{{id}}" class="gform-add btn btn-white"><i data-id="{{id}}"  class="gform-add fa fa-plus text-success"></i></div>\n</div>\n{{/array}}\n{{^hideLabel}}\n{{#label}}<legend>{{{label}}}</legend>{{/label}}\n{{/hideLabel}}\n<div style="position:relative;top:-20px">{{>_addons}}</div>\n</fieldset></div>',_actions:'{{#array}}\n\t<div data-name="{{name}}" class="btn-group hidden-print actions pull-right">\n\t<div data-id="{{id}}" class="btn btn-white gform-minus"><i data-id="{{id}}" class="gform-minus fa fa-minus text-danger"></i></div>\n\t<div data-id="{{id}}" class="gform-add btn btn-white"><i data-id="{{id}}" class="gform-add fa fa-plus text-success"></i></div>\n\t</div>\n\t{{/array}}',_label:'\n    {{^hideLabel}}\n\t<label for="{{name}}" {{#inline}}style="text-align:left"{{/inline}} class="control-label {{#inline}}col-xs-12{{/inline}}{{^inline}}col-md-4{{/inline}}">\n  {{{label}}}{{#required}}{{{requiredText}}}{{/required}}{{suffix}}\n</label>{{#label}}{{/label}}\n{{/hideLabel}}\n    ',_addons:'<span class="help-inline"> {{{help}}}</span>\n<span class="font-xs text-danger" style="display:block;"></span>',checkbox:'<div class="row clearfix {{modifiers}} {{#array}}isArray" data-min="{{multiple.min}}" data-max="{{multiple.max}}{{/array}}" name="{{name}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12" style="margin:0 0 5px">{{/inline}}\n\t{{^inline}}<div class="col-md-8" style="margin:0 0 15px">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t{{#inline}}<div class="col-md-12" style="margin: -10px 0 5px;"">{{/inline}}\n\t{{^inline}}<div class="col-md-8" style="margin: -5px 0 10px">{{/inline}}\n\t{{/label}}\n\t\t<div class="checkbox">\n\t\t\t<label class="{{alt-display}}">\n\t\t\t\t<input name="{{name}}" type="checkbox" {{^editable}}disabled{{/editable}} {{#value}}checked=checked{{/value}}>{{#details}}<span class="noselect">{{{details}}}</span>{{/details}}&nbsp;\n\t\t\t</label>\n\t\t</div>\n\t{{#post}}<span class="input-group-addon">{{{post}}}</span></div>{{/post}}\n\t\t{{>_addons}}\n\t\t{{>_actions}}\n\t</div>\n</div>',switch:'\n<div class="row clearfix {{modifiers}} {{#array}}isArray" data-min="{{multiple.min}}" data-max="{{multiple.max}}{{/array}}" name="{{name}}" data-type="{{type}}">\n{{>_label}}\n<div class="col-md-12" style="margin:0 0 5px">\n<label class="switch">\n<input name="{{name}}" type="checkbox" {{#selected}} checked {{/selected}} value="{{value}}" id="{{name}}" />\n<span class="slider round"></span>\n</label>\n</div>\n    \n    {{>_error}}\n    </div>\n    {{>_actions}}\n</div>',scale:'\n<div class="row clearfix form-group {{modifiers}} {{#multiple.duplicate}}isArray" data-min="{{multiple.min}}" data-max="{{multiple.max}}{{/multiple.duplicate}}" name="{{name}}" data-type="{{type}}">\n\t{{>_label}}\n\t{{>_actions}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12">{{/inline}}\n\t{{^inline}}<div class="col-md-8">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t<div class="col-md-12">\n\t{{/label}}\n\t\t\t<table class="table table-striped">\n\t\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t{{#format.low}}<th></th>{{/format.low}}\n\t\t\t\t\t{{#options}}\n\t\t\t\t\t<th><label for="{{name}}_{{i}}">{{{label}}}</label></th>\n\t\t\t\t\t{{/options}}\n\t\t\t\t\t{{#format.high}}<th></th>{{/format.high}}\n\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t<tr>\n\t\t\t\t\t{{#format.low}}<td><label style="font-weight: 500;" for="{{name}}_1">{{{format.low}}}</label></td>{{/format.low}}\n\t\t\t\t\t{{#options}}\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<input data-label="{{label}}" id="{{name}}_{{i}}" name="{{id}}" value="{{value}}" {{^editable}}readonly disabled{{/editable}} type="radio" {{#selected}}checked=checked{{/selected}} >\n\t\t\t\t\t</td>\n\t\t\t\t\t{{/options}}\n\t\t\t\t\t{{#format.high}}<td><label style="font-weight: 500;" for="{{name}}_{{options.length}}">{{{format.high}}}</label></td>{{/format.high}}\n\t\t\t\t</tr>\n\t\t</tbody>\n\t\t\t</table>\n\t\t{{>_addons}}\n\t</div>\n</div>',button:'<button class="btn btn-default hidden-print {{modifiers}}" style="margin:0 15px">{{{label}}}</button>',tab_container:'\n<form id="{{name}}" style="overflow:hidden" {{^autocomplete}}autocomplete="false"{{/autocomplete}} name="{{name}}" class="gform tab-content {{^options.inline}} smart-form-horizontal form-horizontal{{/options.inline}} {{modifiers}}" {{#action}}action="{{action}}"{{/action}} onsubmit="return false;" {{#method}}method="{{method}}"{{/method}}>{{^legendTarget}}{{#legend}}<legend>{{{legend}}}</legend>{{/legend}}{{/legendTarget}}    \n\t<ul class="nav nav-tabs" style="margin-bottom:15px">\n\t\t{{#fields}}\n\t\t\t{{#section}}\n\t\t\t<li {{^index}}class="active"{{/index}}>\n\t\t\t\t<a href="#tabs{{id}}" data-toggle="tab">{{{legend}}}</a>\n\t\t\t</li>\n\t\t\t{{/section}}\t\t\n\t\t{{/fields}}\n\t</ul></form>\n\t</form><div class="gform-footer row"></div>',tab_fieldset:'{{#section}}<div class="tab-pane {{^index}}active{{/index}} " id="tabs{{id}}">{{/section}}{{>_fieldset}}{{#section}}</div>{{/section}}',modal_container:'<div class="modal fade" id="myModal{{name}}" data-update="{{update}}" data-append="{{append}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n\t<div class="modal-dialog">\n\t\t<div class="modal-content">\n\t\t\t<div class="modal-header {{modal.header_class}}">\n\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n\t\t\t\t<h4 class="modal-title" id="myModalLabel">{{#icon}}<i class="fa fa-{{icon}}"></i> {{/icon}}{{{title}}}{{{legend}}}&nbsp;</h4>\n\t\t\t</div>\n\t\t\t<div class="modal-body">\n\t\t\t\t{{{body}}}\n\t\t\t\t{{^sections}}\n\t\t\t\t<form id="{{name}}" style="overflow:hidden" {{^autocomplete}}autocomplete="false"{{/autocomplete}} name="{{name}}" class="gform {{^options.inline}} smart-form-horizontal form-horizontal{{/options.inline}} {{modifiers}}" {{#action}}action="{{action}}"{{/action}} onsubmit="return false;" {{#method}}method="{{method}}"{{/method}}></form>\n\t\t\t\t{{/sections}}\n\t\t\t\t{{#sections}}\n\t\t\t\t<form id="{{name}}" style="overflow:hidden" {{^autocomplete}}autocomplete="false"{{/autocomplete}} name="{{name}}" class="gform tab-content {{^options.inline}} smart-form-horizontal form-horizontal{{/options.inline}} {{modifiers}}" {{#action}}action="{{action}}"{{/action}} onsubmit="return false;" {{#method}}method="{{method}}"{{/method}}>   \n\t\t\t\t<ul class="nav nav-tabs" style="margin-bottom:15px">\n\t\t\t\t\t{{#fields}}\n\t\t\t\t\t{{#section}}\n\t\t\t\t\t<li {{^index}}class="active"{{/index}}>\n\t\t\t\t\t\t<a href="#tabs{{id}}" data-toggle="tab">{{{legend}}}</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t{{/section}}\t\t\n\t\t\t\t\t{{/fields}}\n\t\t\t\t</ul></form>\n\t\t\t\t{{/sections}}\n\t\t\t\t\n\t\t\t</div>\n\t\t\t<div class="modal-footer gform-footer"  style="padding-right: 0;padding-left: 0;">\n\t\t\t\t{{{footer}}}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n',modal_fieldset:"{{>_fieldset}}"},gform.columns=12,gform.columnClasses=_.map(new Array(13),function(t,e){return"col-xs-"+e}),gform.default.inline=!0,gform.default.columns=12,gform.prototype.opts.suffix="",gform.handleError=function(t){t.valid?(t.el.classList.remove("has-error"),t.el.querySelector(".font-xs.text-danger").innerHTML=""):(t.el.classList.add("has-error"),t.el.querySelector(".font-xs.text-danger").innerHTML=t.errors)},gform.types.reset=_.defaultsDeep({toString:function(){return""}},gform.types.button,{defaults:{label:'<i class="fa fa-times"></i> Reset',action:"reset",modifiers:"btn btn-default"}}),gform.types.cancel=_.defaultsDeep({toString:function(){return""}},gform.types.button,{defaults:{label:'<i class="fa fa-times"></i> Cancel',action:"cancel",modifiers:"btn btn-danger"}}),gform.types.save=_.defaultsDeep({toString:function(){return""}},gform.types.button,{defaults:{label:'<i class="fa fa-check"></i> Save',action:"save",modifiers:"btn btn-success"}}),gform.types.clear=_.defaultsDeep({toString:function(){return""}},gform.types.button,{defaults:{label:'<i class="fa fa-times"></i> Clear',action:"clear",modifiers:"btn btn-warning"}}),gform.types.combo=_.extend({},gform.types.input,gform.types.collection,{initialize:function(){this.combobox=$(this.el).find('select[name="'+this.name+'"]').combobox({appendId:this.id}),this.onchangeEvent=function(){this.value=this.get(),gform.types[this.type].setup.call(this),this.owner.trigger(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this),$(this.el).find("select").on("change",this.onchangeEvent)},destroy:function(){$(this.el).find("select").off("change",this.onchangeEvent)},update:function(t,e){"object"==typeof t&&_.extend(this,this.item,t),this.label=gform.renderString((t||{}).label||this.item.label,this);var i=document.getElementById(this.id);this.destroy(),this.el=gform.types[this.type].create.call(this),i.parentNode.replaceChild(this.el,i),gform.types[this.type].initialize.call(this),this.el.style.display=this.visible?"block":"none",gform.types[this.type].edit.call(this,this.editable),this.combobox=$('select[name="'+this.name+'"]').combobox({appendId:this.id}),e||this.owner.trigger(["change:"+this.name,"change"],this)},render:function(){return void 0===this.mapOptions&&(this.mapOptions=new gform.mapOptions(this,this.value,0,this.owner.collections),this.mapOptions.on("change",function(){this.options=this.mapOptions.getobject(),this.update()}.bind(this))),this.options=this.mapOptions.getobject(),gform.render("select",this)},set:function(t){this.el.querySelector("select").value=t,_.each(this.options.options,function(e,i){e.value!=t&&parseInt(e.value)!=parseInt(t)||(this.el.querySelector('[name="'+this.name+'"]').selectedIndex=i)}.bind(this)),this.el.querySelector("input[type=text]").value=(_.find(this.options,{value:t})||{label:""}).label}}),gform.types.color=_.extend({},gform.types.input,{defaults:{pre:'<i style="display: block;width:20px;height:20px;margin: 0 -5px;"></i>',elType:"text",value:"#000000"},toString:function(){return"<dt>"+this.label+'</dt> <dd><span style="width:20px;height:20px;display: inline-block;top: 5px;position: relative;background:'+this.value+';"></span> '+(this.value||"(empty)")+"</dd><hr>"},initialize:function(){this.onchangeEvent=function(){this.value=this.get(),this.owner.trigger(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this),this.el.addEventListener("input",this.onchangeEvent.bind(null,!0)),$(this.el.querySelector('input[name="'+this.name+'"]')).attr("type","text"),this.el.querySelector("i").style.backgroundColor=this.get(),$(this.el.querySelector('input[name="'+this.name+'"]')).colorpicker({format:"hex"}).on("changeColor",function(t){this.el.querySelector("i").style.backgroundColor=this.get(),this.owner.trigger("change",this)}.bind(this))}}),gform.types.email=_.extend({},gform.types.input,{defaults:{post:'<i class="fa fa-envelope"></i>',validate:[{type:"valid_email"}]}}),gform.types.url=_.extend({},gform.types.input,{defaults:{post:'<i class="fa fa-link"></i>',validate:[{type:"valid_url"}]}}),gform.types.tel=_.extend({},gform.types.input,{defaults:{post:'<i class="fa fa-phone"></i>',placeholder:"+1"}}),gform.types.password=_.extend({},gform.types.input,{defaults:{post:'<i class="fa fa-lock"></i>'}}),gform.types.address=_.extend({},gform.types.input,gform.types.section,{defaults:{fields:[{type:"text",name:"street",label:"Street Address",validate:[{type:"length",max:"255"}]},{type:"text",name:"line2",label:"Address line 2",validate:[{type:"length",max:"150"}]},{type:"text",name:"city",label:"City",validate:[{type:"length",max:"255"}],columns:6},{type:"text",name:"state",label:"State/Province/Region",validate:[{type:"length",max:"255"}],columns:6},{type:"text",name:"zip",label:"Postal/Zip Code",validate:[{type:"length",max:"15"}],columns:6},{type:"select",name:"country",options:"../data/countries.json",format:{label:"{{name}}",value:"{{code}}"},label:"Country",validate:[{type:"length",max:"15"}],columns:6}]}}),gform.stencils.smallcombo='\n<div class="row clearfix form-group {{modifiers}} data-type="{{type}}">\n\t{{>_label}}\n\t{{#label}}\n\t{{#inline}}<div class="col-md-12">{{/inline}}\n\t{{^inline}}<div class="col-md-8">{{/inline}}\n\t{{/label}}\n\t{{^label}}\n\t<div class="col-md-12">\n\t{{/label}}\n    <div class="combobox-container"><div class="input-group"> \n        <input type="text" name="{{name}}" class="form-control"  autocomplete="off"> \n        <ul class="typeahead typeahead-long dropdown-menu"></ul>\n\n        <span class="input-group-addon dropdown-toggle" data-dropdown="dropdown"> <span class="caret"></span> <span class="fa fa-times"></span> </span> \n        </div> \n\n        </div>\n\t\t{{>_addons}}\n\t\t{{>_actions}}\n\t</div>\n</div>\n\t\t',gform.types.smallcombo=_.extend({},gform.types.input,{toString:function(){return"<dt>"+this.label+"</dt> <dd>"+(this.combo.value||"(empty)")+"</dd><hr>"},render:function(){return void 0===this.mapOptions&&(this.mapOptions=new gform.mapOptions(this,this.value,0,this.owner.collections),this.mapOptions.on("change",function(){this.options=this.mapOptions.getoptions(),void 0!==this.value&&gform.types[this.type].set.call(this,this.value)}.bind(this))),this.options=this.mapOptions.getoptions(),this.value=this.value||"",gform.render("smallcombo",this)},get:function(){return this.strict?(_.find(this.options,{value:this.value})||{value:""}).value:this.value},set:function(t,e){var i=_.find(this.options,{value:t});void 0!==i?(this.combo.value=i.label,this.value=i.value,gform.addClass(this.el.querySelector(".combobox-container"),"combobox-selected")):(void 0!==t&&(this.combo.value=t||"",this.value=t||""),gform.toggleClass(this.el.querySelector(".combobox-container"),"combobox-selected",""!==this.value)),gform.types[this.type].setLabel.call(this),e||this.owner.trigger(["change:"+this.name,"change"],this)},initialize:function(){this.onchangeEvent=function(t){this.set(this.combo.value),_.throttle(this.renderMenu,100).call(this),this.owner.trigger(["input:"+this.name,"input"],this,{input:this.value})}.bind(this),this.processOptions=function(t){if(void 0!==t.optgroup)void 0!==t.optgroup.options&&t.optgroup.options.length&&_.each(t.optgroup.options,this.processOptions.bind(this));else if(!1!==this.filter&&(""==this.combo.value||_.score(t.label.toLowerCase(),this.combo.value.toLowerCase())>.1)){var e=document.createElement("li");e.innerHTML=gform.renderString('<a href="javaScript:void(0);" data-index="{{i}}" class="dropdown-item">{{{display}}}{{^display}}{{{label}}}{{/display}}</a>',t),this.menu.appendChild(e),t.filter=!0}else t.filter=!1},this.renderMenu=function(){this.menu.style.display="none",this.shown=!1,this.menu.innerHTML="",this.options=this.mapOptions.getoptions(),_.each(this.options,this.processOptions.bind(this));var t=this.menu.querySelector("li");null!==t&&(gform.addClass(t,"active"),this.menu.style.display="block",this.shown=!0),"string"==typeof this.search&&gform.ajax({path:gform.renderString(this.search,{search:this.combo.value}),success:function(t){index=this.options.length,this.options=this.options.concat(_.map(t,function(t){if(t.i=t.i||++index,void 0!==this.format&&(void 0!==this.format.label&&(t.label=gform.renderString(this.format.label,t)),void 0!==this.format.display&&(t.display=gform.renderString(this.format.display,t)),void 0!==this.format.value&&(t.value=gform.renderString(this.format.value,t))),!this.filter||""==this.combo.value||_.score(t.label.toLowerCase(),this.combo.value.toLowerCase())>.1){var e=document.createElement("li");e.innerHTML=gform.renderString('<a href="javaScript:void(0);"  data-index="{{i}}" class="dropdown-item">{{{display}}}{{^display}}{{{label}}}{{/display}}</a>',t),this.menu.appendChild(e),t.filter=!0}return t}.bind(this)));var e=this.menu.querySelector("li");null!==e?(gform.addClass(e,"active"),this.menu.style.display="block",this.shown=!0):this.value=null,this.owner.trigger(["change:"+this.name,"change"],this,{input:this.value})}.bind(this)})},this.shown=!1,this.input=this.input||!1,this.menu=this.el.querySelector("ul"),this.combo=this.el.querySelector("input"),this.set=gform.types[this.type].set.bind(this),this.select=function(t){var e=_.find(this.options,{i:parseInt(t)});this.set(e.value),this.owner.trigger(["input:"+this.name,"input"],this,{input:this.value}),this.menu.style.display="none",this.shown=!1,this.combo.focus()},$(this.el).on("click",".dropdown-item",function(t){this.select(t.currentTarget.dataset.index),t.stopPropagation()}.bind(this)),this.el.addEventListener("click",function(t){"SPAN"==t.target.nodeName&&this.editable&&(null!==this.el.querySelector(".combobox-selected")?this.set(""):this.shown?(this.menu.style.display="none",this.shown=!1):this.renderMenu(),this.combo.focus())}.bind(this)),this.el.addEventListener("keydown",function(t){if(this.shown){switch(t.keyCode){case 9:case 13:t.preventDefault(),this.select(this.menu.querySelector("li.active a").dataset.index);break;case 27:t.preventDefault(),this.menu.style.display="none",this.shown=!1;break;case 38:t.preventDefault();var e=this.menu.querySelector(".active");if(gform.removeClass(e,"active"),prev=e.previousElementSibling,!prev){var i=this.menu.querySelectorAll("li");prev=i[i.length-1]}if(gform.addClass(prev,"active"),(e=$(this.menu).find(".active")).length){var n=(l=e.position().top)+e.height(),a=$(this.menu).scrollTop();n>(s=$(this.menu).height())?$(this.menu).scrollTop(a+n-s):l<0&&$(this.menu).scrollTop(a+l)}break;case 40:t.preventDefault();e=this.menu.querySelector(".active");if(gform.removeClass(e,"active"),next=e.nextElementSibling,next||(next=this.menu.querySelector("li")),gform.addClass(next,"active"),(e=$(this.menu.querySelector(".active"))).length){var l,s;n=(l=e.position().top)+e.height(),a=$(this.menu).scrollTop();n>(s=$(this.menu).height())?$(this.menu).scrollTop(a+n-s):l<0&&$(this.menu).scrollTop(a+l)}}t.stopPropagation()}else 40==t.keyCode&&this.renderMenu()}.bind(this)),$(this.menu).on("mouseenter","li",function(t){this.mousedover=!0,null!==this.menu.querySelector(".active")&&gform.removeClass(this.menu.querySelector(".active"),"active"),gform.addClass(t.currentTarget,"active")}.bind(this)),$(this.menu).on("mouseleave","li",function(t){this.mousedover=!1}.bind(this)),this.combo.addEventListener("blur",function(t){if(this.shown){var e=_.filter(this.options,{filter:!0});1==e.length?this.set(e[0].value):(e=_.filter(this.options,{label:this.combo.value})).length&&this.set(e[0].value),!this.mousedover&&this.shown&&setTimeout(function(){this.menu.style.display="none",this.shown=!1}.bind(this),200),this.owner.trigger(["input:"+this.name,"input"],this,{input:this.value})}this.set(this.value||this.combo.value),this.set(gform.types[this.type].get.call(this))}.bind(this)),this.options=this.mapOptions.getoptions(),"string"==typeof this.search?gform.ajax({path:gform.renderString(this.search,{value:this.value}),success:function(t){index=this.options.length,this.options=this.options.concat(_.map(t,function(t){if(t.index=(t.index||++index)+"",void 0!==this.format&&(void 0!==this.format.label&&(t.label=gform.renderString(this.format.label,t)),void 0!==this.format.display&&(t.display=gform.renderString(this.format.display,t)),void 0!==this.format.value&&(t.value=gform.renderString(this.format.value,t))),""==this.combo.value||_.score(t.label.toLowerCase(),this.combo.value.toLowerCase())>.1){var e=document.createElement("li");e.innerHTML=gform.renderString('<a href="#" data-index="{{index}}" class="dropdown-item">{{{display}}}{{^display}}{{{label}}}{{/display}}</a>',t),this.menu.appendChild(e)}return t}.bind(this))),void 0!==this.value&&this.set(this.value)}.bind(this)}):void 0!==this.value&&this.set(this.value),this.el.addEventListener("input",this.onchangeEvent.bind(null,!0))}}),gform.THEME={bootstrap:"0.0.4.2"},gform.types.datetime=_.extend({},gform.types.input,{defaults:{format:{input:"MM/DD/YYYY h:mm A"},elType:"text"},initialize:function(){this.onchangeEvent=function(){this.value=this.get(),this.owner.trigger(["change:"+this.name,"change","input:"+this.name,"input"],this,{input:this.value})}.bind(this);var t=$(this.el.querySelector('input[name="'+this.name+'"]'));t.datetimepicker({format:this.format.input}),t.on("dp.change",this.onchangeEvent.bind(null,!0))}}),gform.types.date=_.extend({},gform.types.datetime,{defaults:{format:{input:"MM/DD/YYYY"},elType:"text"}}),gform.types.time=_.extend({},gform.types.datetime,{defaults:{format:{input:"h:mm A"},elType:"text"}}),gform.prototype.modal=function(t){return $(this.el).modal(t),this};
